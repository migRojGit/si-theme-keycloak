import{g as Sr,d as I,e as St,f as Hn,i as tn,r as rn,j as W}from"./index-CbVhUqln.js";const Bn="/assets/react-CHdo91hT.svg",Wn="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--logos'%20width='31.88'%20height='32'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%20256%20257'%3e%3cdefs%3e%3clinearGradient%20id='IconifyId1813088fe1fbc01fb466'%20x1='-.828%25'%20x2='57.636%25'%20y1='7.652%25'%20y2='78.411%25'%3e%3cstop%20offset='0%25'%20stop-color='%2341D1FF'%3e%3c/stop%3e%3cstop%20offset='100%25'%20stop-color='%23BD34FE'%3e%3c/stop%3e%3c/linearGradient%3e%3clinearGradient%20id='IconifyId1813088fe1fbc01fb467'%20x1='43.376%25'%20x2='50.316%25'%20y1='2.242%25'%20y2='89.03%25'%3e%3cstop%20offset='0%25'%20stop-color='%23FFEA83'%3e%3c/stop%3e%3cstop%20offset='8.333%25'%20stop-color='%23FFDD35'%3e%3c/stop%3e%3cstop%20offset='100%25'%20stop-color='%23FFA800'%3e%3c/stop%3e%3c/linearGradient%3e%3c/defs%3e%3cpath%20fill='url(%23IconifyId1813088fe1fbc01fb466)'%20d='M255.153%2037.938L134.897%20252.976c-2.483%204.44-8.862%204.466-11.382.048L.875%2037.958c-2.746-4.814%201.371-10.646%206.827-9.67l120.385%2021.517a6.537%206.537%200%200%200%202.322-.004l117.867-21.483c5.438-.991%209.574%204.796%206.877%209.62Z'%3e%3c/path%3e%3cpath%20fill='url(%23IconifyId1813088fe1fbc01fb467)'%20d='M185.432.063L96.44%2017.501a3.268%203.268%200%200%200-2.634%203.014l-5.474%2092.456a3.268%203.268%200%200%200%203.997%203.378l24.777-5.718c2.318-.535%204.413%201.507%203.936%203.838l-7.361%2036.047c-.495%202.426%201.782%204.5%204.151%203.78l15.304-4.649c2.372-.72%204.652%201.36%204.15%203.788l-11.698%2056.621c-.732%203.542%203.979%205.473%205.943%202.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505%204.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z'%3e%3c/path%3e%3c/svg%3e";var nn={},tt={},rt={};function zn(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sn={exports:{}};const Vn={},Fn=Object.freeze(Object.defineProperty({__proto__:null,default:Vn},Symbol.toStringTag,{value:"Module"})),Jn=Sr(Fn);(function(t,e){(function(r,n){t.exports=n()})(I,function(){var r=r||function(n,s){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof I<"u"&&I.crypto&&(i=I.crypto),!i&&typeof zn=="function")try{i=Jn}catch{}var a=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},c=Object.create||function(){function l(){}return function(g){var w;return l.prototype=g,w=new l,l.prototype=null,w}}(),u={},o=u.lib={},d=o.Base=function(){return{extend:function(l){var g=c(this);return l&&g.mixIn(l),(!g.hasOwnProperty("init")||this.init===g.init)&&(g.init=function(){g.$super.init.apply(this,arguments)}),g.init.prototype=g,g.$super=this,g},create:function(){var l=this.extend();return l.init.apply(l,arguments),l},init:function(){},mixIn:function(l){for(var g in l)l.hasOwnProperty(g)&&(this[g]=l[g]);l.hasOwnProperty("toString")&&(this.toString=l.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),h=o.WordArray=d.extend({init:function(l,g){l=this.words=l||[],g!=s?this.sigBytes=g:this.sigBytes=l.length*4},toString:function(l){return(l||m).stringify(this)},concat:function(l){var g=this.words,w=l.words,S=this.sigBytes,j=l.sigBytes;if(this.clamp(),S%4)for(var A=0;A<j;A++){var N=w[A>>>2]>>>24-A%4*8&255;g[S+A>>>2]|=N<<24-(S+A)%4*8}else for(var Z=0;Z<j;Z+=4)g[S+Z>>>2]=w[Z>>>2];return this.sigBytes+=j,this},clamp:function(){var l=this.words,g=this.sigBytes;l[g>>>2]&=4294967295<<32-g%4*8,l.length=n.ceil(g/4)},clone:function(){var l=d.clone.call(this);return l.words=this.words.slice(0),l},random:function(l){for(var g=[],w=0;w<l;w+=4)g.push(a());return new h.init(g,l)}}),v=u.enc={},m=v.Hex={stringify:function(l){for(var g=l.words,w=l.sigBytes,S=[],j=0;j<w;j++){var A=g[j>>>2]>>>24-j%4*8&255;S.push((A>>>4).toString(16)),S.push((A&15).toString(16))}return S.join("")},parse:function(l){for(var g=l.length,w=[],S=0;S<g;S+=2)w[S>>>3]|=parseInt(l.substr(S,2),16)<<24-S%8*4;return new h.init(w,g/2)}},R=v.Latin1={stringify:function(l){for(var g=l.words,w=l.sigBytes,S=[],j=0;j<w;j++){var A=g[j>>>2]>>>24-j%4*8&255;S.push(String.fromCharCode(A))}return S.join("")},parse:function(l){for(var g=l.length,w=[],S=0;S<g;S++)w[S>>>2]|=(l.charCodeAt(S)&255)<<24-S%4*8;return new h.init(w,g)}},y=v.Utf8={stringify:function(l){try{return decodeURIComponent(escape(R.stringify(l)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(l){return R.parse(unescape(encodeURIComponent(l)))}},T=o.BufferedBlockAlgorithm=d.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(l){typeof l=="string"&&(l=y.parse(l)),this._data.concat(l),this._nDataBytes+=l.sigBytes},_process:function(l){var g,w=this._data,S=w.words,j=w.sigBytes,A=this.blockSize,N=A*4,Z=j/N;l?Z=n.ceil(Z):Z=n.max((Z|0)-this._minBufferSize,0);var K=Z*A,D=n.min(K*4,j);if(K){for(var re=0;re<K;re+=A)this._doProcessBlock(S,re);g=S.splice(0,K),w.sigBytes-=D}return new h.init(g,D)},clone:function(){var l=d.clone.call(this);return l._data=this._data.clone(),l},_minBufferSize:0});o.Hasher=T.extend({cfg:d.extend(),init:function(l){this.cfg=this.cfg.extend(l),this.reset()},reset:function(){T.reset.call(this),this._doReset()},update:function(l){return this._append(l),this._process(),this},finalize:function(l){l&&this._append(l);var g=this._doFinalize();return g},blockSize:16,_createHelper:function(l){return function(g,w){return new l.init(w).finalize(g)}},_createHmacHelper:function(l){return function(g,w){return new b.HMAC.init(l,w).finalize(g)}}});var b=u.algo={};return u}(Math);return r})})(sn);var Ht=sn.exports,an={exports:{}};(function(t,e){(function(r,n){t.exports=n(Ht)})(I,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,c=i.Hasher,u=s.algo,o=[],d=[];(function(){function m(b){for(var l=n.sqrt(b),g=2;g<=l;g++)if(!(b%g))return!1;return!0}function R(b){return(b-(b|0))*4294967296|0}for(var y=2,T=0;T<64;)m(y)&&(T<8&&(o[T]=R(n.pow(y,1/2))),d[T]=R(n.pow(y,1/3)),T++),y++})();var h=[],v=u.SHA256=c.extend({_doReset:function(){this._hash=new a.init(o.slice(0))},_doProcessBlock:function(m,R){for(var y=this._hash.words,T=y[0],b=y[1],l=y[2],g=y[3],w=y[4],S=y[5],j=y[6],A=y[7],N=0;N<64;N++){if(N<16)h[N]=m[R+N]|0;else{var Z=h[N-15],K=(Z<<25|Z>>>7)^(Z<<14|Z>>>18)^Z>>>3,D=h[N-2],re=(D<<15|D>>>17)^(D<<13|D>>>19)^D>>>10;h[N]=K+h[N-7]+re+h[N-16]}var de=w&S^~w&j,ve=T&b^T&l^b&l,je=(T<<30|T>>>2)^(T<<19|T>>>13)^(T<<10|T>>>22),We=(w<<26|w>>>6)^(w<<21|w>>>11)^(w<<7|w>>>25),Q=A+We+de+d[N]+h[N],ze=je+ve;A=j,j=S,S=w,w=g+Q|0,g=l,l=b,b=T,T=Q+ze|0}y[0]=y[0]+T|0,y[1]=y[1]+b|0,y[2]=y[2]+l|0,y[3]=y[3]+g|0,y[4]=y[4]+w|0,y[5]=y[5]+S|0,y[6]=y[6]+j|0,y[7]=y[7]+A|0},_doFinalize:function(){var m=this._data,R=m.words,y=this._nDataBytes*8,T=m.sigBytes*8;return R[T>>>5]|=128<<24-T%32,R[(T+64>>>9<<4)+14]=n.floor(y/4294967296),R[(T+64>>>9<<4)+15]=y,m.sigBytes=R.length*4,this._process(),this._hash},clone:function(){var m=c.clone.call(this);return m._hash=this._hash.clone(),m}});s.SHA256=c._createHelper(v),s.HmacSHA256=c._createHmacHelper(v)}(Math),r.SHA256})})(an);var Kn=an.exports,on={exports:{}};(function(t,e){(function(r,n){t.exports=n(Ht)})(I,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Base64={stringify:function(u){var o=u.words,d=u.sigBytes,h=this._map;u.clamp();for(var v=[],m=0;m<d;m+=3)for(var R=o[m>>>2]>>>24-m%4*8&255,y=o[m+1>>>2]>>>24-(m+1)%4*8&255,T=o[m+2>>>2]>>>24-(m+2)%4*8&255,b=R<<16|y<<8|T,l=0;l<4&&m+l*.75<d;l++)v.push(h.charAt(b>>>6*(3-l)&63));var g=h.charAt(64);if(g)for(;v.length%4;)v.push(g);return v.join("")},parse:function(u){var o=u.length,d=this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var v=0;v<d.length;v++)h[d.charCodeAt(v)]=v}var m=d.charAt(64);if(m){var R=u.indexOf(m);R!==-1&&(o=R)}return c(u,o,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function c(u,o,d){for(var h=[],v=0,m=0;m<o;m++)if(m%4){var R=d[u.charCodeAt(m-1)]<<m%4*2,y=d[u.charCodeAt(m)]>>>6-m%4*2,T=R|y;h[v>>>2]|=T<<24-v%4*8,v++}return i.create(h,v)}}(),r.enc.Base64})})(on);var Qn=on.exports,cn={exports:{}};(function(t,e){(function(r,n){t.exports=n(Ht)})(I,function(r){return r.enc.Utf8})})(cn);var Gn=cn.exports;function gr(t){this.message=t}gr.prototype=new Error,gr.prototype.name="InvalidCharacterError";var Ur=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new gr("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,s=0,i=0,a="";n=e.charAt(i++);~n&&(r=s%4?64*r+n:n,s++%4)?a+=String.fromCharCode(255&r>>(-2*s&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return a};function Yn(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(r){return decodeURIComponent(Ur(r).replace(/(.)/g,function(n,s){var i=s.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}(e)}catch{return Ur(e)}}function dt(t){this.message=t}function Xn(t,e){if(typeof t!="string")throw new dt("Invalid token specified");var r=(e=e||{}).header===!0?0:1;try{return JSON.parse(Yn(t.split(".")[r]))}catch(n){throw new dt("Invalid token specified: "+n.message)}}dt.prototype=new Error,dt.prototype.name="InvalidTokenError";const es=Object.freeze(Object.defineProperty({__proto__:null,InvalidTokenError:dt,default:Xn},Symbol.toStringTag,{value:"Module"})),xr=Sr(es);var ts=Object.create,Bt=Object.defineProperty,rs=Object.getOwnPropertyDescriptor,ns=Object.getOwnPropertyNames,ss=Object.getPrototypeOf,is=Object.prototype.hasOwnProperty,as=(t,e)=>{for(var r in e)Bt(t,r,{get:e[r],enumerable:!0})},dn=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ns(e))!is.call(t,s)&&s!==r&&Bt(t,s,{get:()=>e[s],enumerable:!(n=rs(e,s))||n.enumerable});return t},xt=(t,e,r)=>(r=t!=null?ts(ss(t)):{},dn(e||!t||!t.__esModule?Bt(r,"default",{value:t,enumerable:!0}):r,t)),os=t=>dn(Bt({},"__esModule",{value:!0}),t),un={};as(un,{AccessTokenEvents:()=>ln,CheckSessionIFrame:()=>hn,ErrorResponse:()=>Re,ErrorTimeout:()=>Wt,InMemoryWebStorage:()=>Tr,Log:()=>ut,Logger:()=>E,MetadataService:()=>fn,OidcClient:()=>_n,OidcClientSettingsStore:()=>Pt,SessionMonitor:()=>mn,SigninResponse:()=>Rt,SigninState:()=>zt,SignoutResponse:()=>pn,State:()=>$e,User:()=>ct,UserManager:()=>$s,UserManagerSettingsStore:()=>kn,Version:()=>qs,WebStorageStateStore:()=>Er});var cs=os(un),ds=xt(Ht),us=xt(Kn),Pr=xt(Qn),ls=xt(Gn),hs={debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}},he,fe,ut=(t=>(t[t.NONE=0]="NONE",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG",t))(ut||{});(t=>{function e(){he=3,fe=hs}t.reset=e;function r(s){if(!(0<=s&&s<=4))throw new Error("Invalid log level");he=s}t.setLevel=r;function n(s){fe=s}t.setLogger=n})(ut||(ut={}));var E=class{constructor(t){this._name=t}debug(...t){he>=4&&fe.debug(E._format(this._name,this._method),...t)}info(...t){he>=3&&fe.info(E._format(this._name,this._method),...t)}warn(...t){he>=2&&fe.warn(E._format(this._name,this._method),...t)}error(...t){he>=1&&fe.error(E._format(this._name,this._method),...t)}throw(t){throw this.error(t),t}create(t){const e=Object.create(this);return e._method=t,e.debug("begin"),e}static createStatic(t,e){const r=new E(`${t}.${e}`);return r.debug("begin"),r}static _format(t,e){const r=`[${t}]`;return e?`${r} ${e}:`:r}static debug(t,...e){he>=4&&fe.debug(E._format(t),...e)}static info(t,...e){he>=3&&fe.info(E._format(t),...e)}static warn(t,...e){he>=2&&fe.warn(E._format(t),...e)}static error(t,...e){he>=1&&fe.error(E._format(t),...e)}};ut.reset();var fs="10000000-1000-4000-8000-100000000000",pe=class{static _randomWord(){return ds.default.lib.WordArray.random(1).words[0]}static generateUUIDv4(){return fs.replace(/[018]/g,e=>(+e^pe._randomWord()&15>>+e/4).toString(16)).replace(/-/g,"")}static generateCodeVerifier(){return pe.generateUUIDv4()+pe.generateUUIDv4()+pe.generateUUIDv4()}static generateCodeChallenge(t){try{const e=(0,us.default)(t);return Pr.default.stringify(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}catch(e){throw E.error("CryptoUtils.generateCodeChallenge",e),e}}static generateBasicAuth(t,e){const r=ls.default.parse([t,e].join(":"));return Pr.default.stringify(r)}},Ee=class{constructor(t){this._name=t,this._logger=new E(`Event('${this._name}')`),this._callbacks=[]}addHandler(t){return this._callbacks.push(t),()=>this.removeHandler(t)}removeHandler(t){const e=this._callbacks.lastIndexOf(t);e>=0&&this._callbacks.splice(e,1)}raise(...t){this._logger.debug("raise:",...t);for(const e of this._callbacks)e(...t)}},gs=xt(xr),pr=class{static decode(t){try{return(0,gs.default)(t)}catch(e){throw E.error("JwtUtils.decode",e),e}}},Ar=class{static center({...t}){var e,r,n;return t.width==null&&(t.width=(e=[800,720,600,480].find(s=>s<=window.outerWidth/1.618))!=null?e:360),(r=t.left)!=null||(t.left=Math.max(0,Math.round(window.screenX+(window.outerWidth-t.width)/2))),t.height!=null&&((n=t.top)!=null||(t.top=Math.max(0,Math.round(window.screenY+(window.outerHeight-t.height)/2)))),t}static serialize(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,r])=>`${e}=${typeof r!="boolean"?r:r?"yes":"no"}`).join(",")}},ne=class extends Ee{constructor(){super(...arguments),this._logger=new E(`Timer('${this._name}')`),this._timerHandle=null,this._expiration=0,this._callback=()=>{const t=this._expiration-ne.getEpochTime();this._logger.debug("timer completes in",t),this._expiration<=ne.getEpochTime()&&(this.cancel(),super.raise())}}static getEpochTime(){return Math.floor(Date.now()/1e3)}init(t){const e=this._logger.create("init");t=Math.max(Math.floor(t),1);const r=ne.getEpochTime()+t;if(this.expiration===r&&this._timerHandle){e.debug("skipping since already initialized for expiration at",this.expiration);return}this.cancel(),e.debug("using duration",t),this._expiration=r;const n=Math.min(t,5);this._timerHandle=setInterval(this._callback,n*1e3)}get expiration(){return this._expiration}cancel(){this._logger.create("cancel"),this._timerHandle&&(clearInterval(this._timerHandle),this._timerHandle=null)}},_r=class{static readParams(t,e="query"){if(!t)throw new TypeError("Invalid URL");const n=new URL(t,"http://127.0.0.1")[e==="fragment"?"hash":"search"];return new URLSearchParams(n.slice(1))}},mr=";",Re=class extends Error{constructor(t,e){var r,n,s;if(super(t.error_description||t.error||""),this.form=e,this.name="ErrorResponse",!t.error)throw E.error("ErrorResponse","No error passed"),new Error("No error passed");this.error=t.error,this.error_description=(r=t.error_description)!=null?r:null,this.error_uri=(n=t.error_uri)!=null?n:null,this.state=t.userState,this.session_state=(s=t.session_state)!=null?s:null,this.url_state=t.url_state}},Wt=class extends Error{constructor(t){super(t),this.name="ErrorTimeout"}},ln=class{constructor(t){this._logger=new E("AccessTokenEvents"),this._expiringTimer=new ne("Access token expiring"),this._expiredTimer=new ne("Access token expired"),this._expiringNotificationTimeInSeconds=t.expiringNotificationTimeInSeconds}load(t){const e=this._logger.create("load");if(t.access_token&&t.expires_in!==void 0){const r=t.expires_in;if(e.debug("access token present, remaining duration:",r),r>0){let s=r-this._expiringNotificationTimeInSeconds;s<=0&&(s=1),e.debug("registering expiring timer, raising in",s,"seconds"),this._expiringTimer.init(s)}else e.debug("canceling existing expiring timer because we're past expiration."),this._expiringTimer.cancel();const n=r+1;e.debug("registering expired timer, raising in",n,"seconds"),this._expiredTimer.init(n)}else this._expiringTimer.cancel(),this._expiredTimer.cancel()}unload(){this._logger.debug("unload: canceling existing access token timers"),this._expiringTimer.cancel(),this._expiredTimer.cancel()}addAccessTokenExpiring(t){return this._expiringTimer.addHandler(t)}removeAccessTokenExpiring(t){this._expiringTimer.removeHandler(t)}addAccessTokenExpired(t){return this._expiredTimer.addHandler(t)}removeAccessTokenExpired(t){this._expiredTimer.removeHandler(t)}},hn=class{constructor(t,e,r,n,s){this._callback=t,this._client_id=e,this._intervalInSeconds=n,this._stopOnError=s,this._logger=new E("CheckSessionIFrame"),this._timer=null,this._session_state=null,this._message=a=>{a.origin===this._frame_origin&&a.source===this._frame.contentWindow&&(a.data==="error"?(this._logger.error("error message from check session op iframe"),this._stopOnError&&this.stop()):a.data==="changed"?(this._logger.debug("changed message from check session op iframe"),this.stop(),this._callback()):this._logger.debug(a.data+" message from check session op iframe"))};const i=new URL(r);this._frame_origin=i.origin,this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="fixed",this._frame.style.left="-1000px",this._frame.style.top="0",this._frame.width="0",this._frame.height="0",this._frame.src=i.href}load(){return new Promise(t=>{this._frame.onload=()=>{t()},window.document.body.appendChild(this._frame),window.addEventListener("message",this._message,!1)})}start(t){if(this._session_state===t)return;this._logger.create("start"),this.stop(),this._session_state=t;const e=()=>{!this._frame.contentWindow||!this._session_state||this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};e(),this._timer=setInterval(e,this._intervalInSeconds*1e3)}stop(){this._logger.create("stop"),this._session_state=null,this._timer&&(clearInterval(this._timer),this._timer=null)}},Tr=class{constructor(){this._logger=new E("InMemoryWebStorage"),this._data={}}clear(){this._logger.create("clear"),this._data={}}getItem(t){return this._logger.create(`getItem('${t}')`),this._data[t]}setItem(t,e){this._logger.create(`setItem('${t}')`),this._data[t]=e}removeItem(t){this._logger.create(`removeItem('${t}')`),delete this._data[t]}get length(){return Object.getOwnPropertyNames(this._data).length}key(t){return Object.getOwnPropertyNames(this._data)[t]}},Ir=class{constructor(t=[],e=null,r={}){this._jwtHandler=e,this._extraHeaders=r,this._logger=new E("JsonService"),this._contentTypes=[],this._contentTypes.push(...t,"application/json"),e&&this._contentTypes.push("application/jwt")}async fetchWithTimeout(t,e={}){const{timeoutInSeconds:r,...n}=e;if(!r)return await fetch(t,n);const s=new AbortController,i=setTimeout(()=>s.abort(),r*1e3);try{return await fetch(t,{...e,signal:s.signal})}catch(a){throw a instanceof DOMException&&a.name==="AbortError"?new Wt("Network timed out"):a}finally{clearTimeout(i)}}async getJson(t,{token:e,credentials:r}={}){const n=this._logger.create("getJson"),s={Accept:this._contentTypes.join(", ")};e&&(n.debug("token passed, setting Authorization header"),s.Authorization="Bearer "+e),this.appendExtraHeaders(s);let i;try{n.debug("url:",t),i=await this.fetchWithTimeout(t,{method:"GET",headers:s,credentials:r})}catch(u){throw n.error("Network Error"),u}n.debug("HTTP response received, status",i.status);const a=i.headers.get("Content-Type");if(a&&!this._contentTypes.find(u=>a.startsWith(u))&&n.throw(new Error(`Invalid response Content-Type: ${a??"undefined"}, from URL: ${t}`)),i.ok&&this._jwtHandler&&(a!=null&&a.startsWith("application/jwt")))return await this._jwtHandler(await i.text());let c;try{c=await i.json()}catch(u){throw n.error("Error parsing JSON response",u),i.ok?u:new Error(`${i.statusText} (${i.status})`)}if(!i.ok)throw n.error("Error from server:",c),c.error?new Re(c):new Error(`${i.statusText} (${i.status}): ${JSON.stringify(c)}`);return c}async postForm(t,{body:e,basicAuth:r,timeoutInSeconds:n,initCredentials:s}){const i=this._logger.create("postForm"),a={Accept:this._contentTypes.join(", "),"Content-Type":"application/x-www-form-urlencoded"};r!==void 0&&(a.Authorization="Basic "+r),this.appendExtraHeaders(a);let c;try{i.debug("url:",t),c=await this.fetchWithTimeout(t,{method:"POST",headers:a,body:e,timeoutInSeconds:n,credentials:s})}catch(h){throw i.error("Network error"),h}i.debug("HTTP response received, status",c.status);const u=c.headers.get("Content-Type");if(u&&!this._contentTypes.find(h=>u.startsWith(h)))throw new Error(`Invalid response Content-Type: ${u??"undefined"}, from URL: ${t}`);const o=await c.text();let d={};if(o)try{d=JSON.parse(o)}catch(h){throw i.error("Error parsing JSON response",h),c.ok?h:new Error(`${c.statusText} (${c.status})`)}if(!c.ok)throw i.error("Error from server:",d),d.error?new Re(d,e):new Error(`${c.statusText} (${c.status}): ${JSON.stringify(d)}`);return d}appendExtraHeaders(t){const e=this._logger.create("appendExtraHeaders"),r=Object.keys(this._extraHeaders),n=["authorization","accept","content-type"];r.length!==0&&r.forEach(s=>{if(n.includes(s.toLocaleLowerCase())){e.warn("Protected header could not be overridden",s,n);return}const i=typeof this._extraHeaders[s]=="function"?this._extraHeaders[s]():this._extraHeaders[s];i&&i!==""&&(t[s]=i)})}},fn=class{constructor(t){this._settings=t,this._logger=new E("MetadataService"),this._signingKeys=null,this._metadata=null,this._metadataUrl=this._settings.metadataUrl,this._jsonService=new Ir(["application/jwk-set+json"],null,this._settings.extraHeaders),this._settings.signingKeys&&(this._logger.debug("using signingKeys from settings"),this._signingKeys=this._settings.signingKeys),this._settings.metadata&&(this._logger.debug("using metadata from settings"),this._metadata=this._settings.metadata),this._settings.fetchRequestCredentials&&(this._logger.debug("using fetchRequestCredentials from settings"),this._fetchRequestCredentials=this._settings.fetchRequestCredentials)}resetSigningKeys(){this._signingKeys=null}async getMetadata(){const t=this._logger.create("getMetadata");if(this._metadata)return t.debug("using cached values"),this._metadata;if(!this._metadataUrl)throw t.throw(new Error("No authority or metadataUrl configured on settings")),null;t.debug("getting metadata from",this._metadataUrl);const e=await this._jsonService.getJson(this._metadataUrl,{credentials:this._fetchRequestCredentials});return t.debug("merging remote JSON with seed metadata"),this._metadata=Object.assign({},this._settings.metadataSeed,e),this._metadata}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(t=!0){return this._getMetadataProperty("token_endpoint",t)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(t=!0){return this._getMetadataProperty("revocation_endpoint",t)}getKeysEndpoint(t=!0){return this._getMetadataProperty("jwks_uri",t)}async _getMetadataProperty(t,e=!1){const r=this._logger.create(`_getMetadataProperty('${t}')`),n=await this.getMetadata();if(r.debug("resolved"),n[t]===void 0){if(e===!0){r.warn("Metadata does not contain optional property");return}r.throw(new Error("Metadata does not contain property "+t))}return n[t]}async getSigningKeys(){const t=this._logger.create("getSigningKeys");if(this._signingKeys)return t.debug("returning signingKeys from cache"),this._signingKeys;const e=await this.getKeysEndpoint(!1);t.debug("got jwks_uri",e);const r=await this._jsonService.getJson(e);if(t.debug("got key set",r),!Array.isArray(r.keys))throw t.throw(new Error("Missing keys on keyset")),null;return this._signingKeys=r.keys,this._signingKeys}},Er=class{constructor({prefix:t="oidc.",store:e=localStorage}={}){this._logger=new E("WebStorageStateStore"),this._store=e,this._prefix=t}async set(t,e){this._logger.create(`set('${t}')`),t=this._prefix+t,await this._store.setItem(t,e)}async get(t){return this._logger.create(`get('${t}')`),t=this._prefix+t,await this._store.getItem(t)}async remove(t){this._logger.create(`remove('${t}')`),t=this._prefix+t;const e=await this._store.getItem(t);return await this._store.removeItem(t),e}async getAllKeys(){this._logger.create("getAllKeys");const t=await this._store.length,e=[];for(let r=0;r<t;r++){const n=await this._store.key(r);n&&n.indexOf(this._prefix)===0&&e.push(n.substr(this._prefix.length))}return e}},ps="code",_s="openid",ms="client_secret_post",vs="query",ys=60*15,ws=60*5,Pt=class{constructor({authority:t,metadataUrl:e,metadata:r,signingKeys:n,metadataSeed:s,client_id:i,client_secret:a,response_type:c=ps,scope:u=_s,redirect_uri:o,post_logout_redirect_uri:d,client_authentication:h=ms,prompt:v,display:m,max_age:R,ui_locales:y,acr_values:T,resource:b,response_mode:l=vs,filterProtocolClaims:g=!0,loadUserInfo:w=!1,staleStateAgeInSeconds:S=ys,clockSkewInSeconds:j=ws,userInfoJwtIssuer:A="OP",mergeClaims:N=!1,disablePKCE:Z=!1,stateStore:K,refreshTokenCredentials:D,revokeTokenAdditionalContentTypes:re,fetchRequestCredentials:de,refreshTokenAllowedScope:ve,extraQueryParams:je={},extraTokenParams:We={},extraHeaders:Q={}}){if(this.authority=t,e?this.metadataUrl=e:(this.metadataUrl=t,t&&(this.metadataUrl.endsWith("/")||(this.metadataUrl+="/"),this.metadataUrl+=".well-known/openid-configuration")),this.metadata=r,this.metadataSeed=s,this.signingKeys=n,this.client_id=i,this.client_secret=a,this.response_type=c,this.scope=u,this.redirect_uri=o,this.post_logout_redirect_uri=d,this.client_authentication=h,this.prompt=v,this.display=m,this.max_age=R,this.ui_locales=y,this.acr_values=T,this.resource=b,this.response_mode=l,this.filterProtocolClaims=g??!0,this.loadUserInfo=!!w,this.staleStateAgeInSeconds=S,this.clockSkewInSeconds=j,this.userInfoJwtIssuer=A,this.mergeClaims=!!N,this.disablePKCE=!!Z,this.revokeTokenAdditionalContentTypes=re,de&&D&&console.warn("Both fetchRequestCredentials and refreshTokenCredentials is set. Only fetchRequestCredentials will be used."),this.fetchRequestCredentials=de||D||"same-origin",K)this.stateStore=K;else{const ze=typeof window<"u"?window.localStorage:new Tr;this.stateStore=new Er({store:ze})}this.refreshTokenAllowedScope=ve,this.extraQueryParams=je,this.extraTokenParams=We,this.extraHeaders=Q}},bs=class{constructor(t,e){this._settings=t,this._metadataService=e,this._logger=new E("UserInfoService"),this._getClaimsFromJwt=async r=>{const n=this._logger.create("_getClaimsFromJwt");try{const s=pr.decode(r);return n.debug("JWT decoding successful"),s}catch(s){throw n.error("Error parsing JWT response"),s}},this._jsonService=new Ir(void 0,this._getClaimsFromJwt,this._settings.extraHeaders)}async getClaims(t){const e=this._logger.create("getClaims");t||this._logger.throw(new Error("No token passed"));const r=await this._metadataService.getUserInfoEndpoint();e.debug("got userinfo url",r);const n=await this._jsonService.getJson(r,{token:t,credentials:this._settings.fetchRequestCredentials});return e.debug("got claims",n),n}},gn=class{constructor(t,e){this._settings=t,this._metadataService=e,this._logger=new E("TokenClient"),this._jsonService=new Ir(this._settings.revokeTokenAdditionalContentTypes,null,this._settings.extraHeaders)}async exchangeCode({grant_type:t="authorization_code",redirect_uri:e=this._settings.redirect_uri,client_id:r=this._settings.client_id,client_secret:n=this._settings.client_secret,...s}){const i=this._logger.create("exchangeCode");r||i.throw(new Error("A client_id is required")),e||i.throw(new Error("A redirect_uri is required")),s.code||i.throw(new Error("A code is required"));const a=new URLSearchParams({grant_type:t,redirect_uri:e});for(const[d,h]of Object.entries(s))h!=null&&a.set(d,h);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(!n)throw i.throw(new Error("A client_secret is required")),null;c=pe.generateBasicAuth(r,n);break;case"client_secret_post":a.append("client_id",r),n&&a.append("client_secret",n);break}const u=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const o=await this._jsonService.postForm(u,{body:a,basicAuth:c,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),o}async exchangeCredentials({grant_type:t="password",client_id:e=this._settings.client_id,client_secret:r=this._settings.client_secret,scope:n=this._settings.scope,...s}){const i=this._logger.create("exchangeCredentials");e||i.throw(new Error("A client_id is required"));const a=new URLSearchParams({grant_type:t,scope:n});for(const[d,h]of Object.entries(s))h!=null&&a.set(d,h);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw i.throw(new Error("A client_secret is required")),null;c=pe.generateBasicAuth(e,r);break;case"client_secret_post":a.append("client_id",e),r&&a.append("client_secret",r);break}const u=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const o=await this._jsonService.postForm(u,{body:a,basicAuth:c,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),o}async exchangeRefreshToken({grant_type:t="refresh_token",client_id:e=this._settings.client_id,client_secret:r=this._settings.client_secret,timeoutInSeconds:n,...s}){const i=this._logger.create("exchangeRefreshToken");e||i.throw(new Error("A client_id is required")),s.refresh_token||i.throw(new Error("A refresh_token is required"));const a=new URLSearchParams({grant_type:t});for(const[d,h]of Object.entries(s))Array.isArray(h)?h.forEach(v=>a.append(d,v)):h!=null&&a.set(d,h);let c;switch(this._settings.client_authentication){case"client_secret_basic":if(!r)throw i.throw(new Error("A client_secret is required")),null;c=pe.generateBasicAuth(e,r);break;case"client_secret_post":a.append("client_id",e),r&&a.append("client_secret",r);break}const u=await this._metadataService.getTokenEndpoint(!1);i.debug("got token endpoint");const o=await this._jsonService.postForm(u,{body:a,basicAuth:c,timeoutInSeconds:n,initCredentials:this._settings.fetchRequestCredentials});return i.debug("got response"),o}async revoke(t){var e;const r=this._logger.create("revoke");t.token||r.throw(new Error("A token is required"));const n=await this._metadataService.getRevocationEndpoint(!1);r.debug(`got revocation endpoint, revoking ${(e=t.token_type_hint)!=null?e:"default token type"}`);const s=new URLSearchParams;for(const[i,a]of Object.entries(t))a!=null&&s.set(i,a);s.set("client_id",this._settings.client_id),this._settings.client_secret&&s.set("client_secret",this._settings.client_secret),await this._jsonService.postForm(n,{body:s}),r.debug("got response")}},ks=class{constructor(t,e,r){this._settings=t,this._metadataService=e,this._claimsService=r,this._logger=new E("ResponseValidator"),this._userInfoService=new bs(this._settings,this._metadataService),this._tokenClient=new gn(this._settings,this._metadataService)}async validateSigninResponse(t,e){const r=this._logger.create("validateSigninResponse");this._processSigninState(t,e),r.debug("state processed"),await this._processCode(t,e),r.debug("code processed"),t.isOpenId&&this._validateIdTokenAttributes(t),r.debug("tokens validated"),await this._processClaims(t,e==null?void 0:e.skipUserInfo,t.isOpenId),r.debug("claims processed")}async validateCredentialsResponse(t,e){const r=this._logger.create("validateCredentialsResponse");t.isOpenId&&t.id_token&&this._validateIdTokenAttributes(t),r.debug("tokens validated"),await this._processClaims(t,e,t.isOpenId),r.debug("claims processed")}async validateRefreshResponse(t,e){var r,n;const s=this._logger.create("validateRefreshResponse");t.userState=e.data,(r=t.session_state)!=null||(t.session_state=e.session_state),(n=t.scope)!=null||(t.scope=e.scope),t.isOpenId&&t.id_token&&(this._validateIdTokenAttributes(t,e.id_token),s.debug("ID Token validated")),t.id_token||(t.id_token=e.id_token,t.profile=e.profile);const i=t.isOpenId&&!!t.id_token;await this._processClaims(t,!1,i),s.debug("claims processed")}validateSignoutResponse(t,e){const r=this._logger.create("validateSignoutResponse");if(e.id!==t.state&&r.throw(new Error("State does not match")),r.debug("state validated"),t.userState=e.data,t.error)throw r.warn("Response was error",t.error),new Re(t)}_processSigninState(t,e){var r;const n=this._logger.create("_processSigninState");if(e.id!==t.state&&n.throw(new Error("State does not match")),e.client_id||n.throw(new Error("No client_id on state")),e.authority||n.throw(new Error("No authority on state")),this._settings.authority!==e.authority&&n.throw(new Error("authority mismatch on settings vs. signin state")),this._settings.client_id&&this._settings.client_id!==e.client_id&&n.throw(new Error("client_id mismatch on settings vs. signin state")),n.debug("state validated"),t.userState=e.data,t.url_state=e.url_state,(r=t.scope)!=null||(t.scope=e.scope),t.error)throw n.warn("Response was error",t.error),new Re(t);e.code_verifier&&!t.code&&n.throw(new Error("Expected code in response"))}async _processClaims(t,e=!1,r=!0){const n=this._logger.create("_processClaims");if(t.profile=this._claimsService.filterProtocolClaims(t.profile),e||!this._settings.loadUserInfo||!t.access_token){n.debug("not loading user info");return}n.debug("loading user info");const s=await this._userInfoService.getClaims(t.access_token);n.debug("user info claims received from user info endpoint"),r&&s.sub!==t.profile.sub&&n.throw(new Error("subject from UserInfo response does not match subject in ID Token")),t.profile=this._claimsService.mergeClaims(t.profile,this._claimsService.filterProtocolClaims(s)),n.debug("user info claims received, updated profile:",t.profile)}async _processCode(t,e){const r=this._logger.create("_processCode");if(t.code){r.debug("Validating code");const n=await this._tokenClient.exchangeCode({client_id:e.client_id,client_secret:e.client_secret,code:t.code,redirect_uri:e.redirect_uri,code_verifier:e.code_verifier,...e.extraTokenParams});Object.assign(t,n)}else r.debug("No code to process")}_validateIdTokenAttributes(t,e){var r;const n=this._logger.create("_validateIdTokenAttributes");n.debug("decoding ID Token JWT");const s=pr.decode((r=t.id_token)!=null?r:"");if(s.sub||n.throw(new Error("ID Token is missing a subject claim")),e){const i=pr.decode(e);s.sub!==i.sub&&n.throw(new Error("sub in id_token does not match current sub")),s.auth_time&&s.auth_time!==i.auth_time&&n.throw(new Error("auth_time in id_token does not match original auth_time")),s.azp&&s.azp!==i.azp&&n.throw(new Error("azp in id_token does not match original azp")),!s.azp&&i.azp&&n.throw(new Error("azp not in id_token, but present in original id_token"))}t.profile=s}},$e=class{constructor(t){this.id=t.id||pe.generateUUIDv4(),this.data=t.data,t.created&&t.created>0?this.created=t.created:this.created=ne.getEpochTime(),this.request_type=t.request_type,this.url_state=t.url_state}toStorageString(){return new E("State").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state})}static fromStorageString(t){return E.createStatic("State","fromStorageString"),new $e(JSON.parse(t))}static async clearStaleState(t,e){const r=E.createStatic("State","clearStaleState"),n=ne.getEpochTime()-e,s=await t.getAllKeys();r.debug("got keys",s);for(let i=0;i<s.length;i++){const a=s[i],c=await t.get(a);let u=!1;if(c)try{const o=$e.fromStorageString(c);r.debug("got item from key:",a,o.created),o.created<=n&&(u=!0)}catch(o){r.error("Error parsing state for key:",a,o),u=!0}else r.debug("no item in storage for key:",a),u=!0;u&&(r.debug("removed item for key:",a),t.remove(a))}}},zt=class extends $e{constructor(t){super(t),t.code_verifier===!0?this.code_verifier=pe.generateCodeVerifier():t.code_verifier&&(this.code_verifier=t.code_verifier),this.code_verifier&&(this.code_challenge=pe.generateCodeChallenge(this.code_verifier)),this.authority=t.authority,this.client_id=t.client_id,this.redirect_uri=t.redirect_uri,this.scope=t.scope,this.client_secret=t.client_secret,this.extraTokenParams=t.extraTokenParams,this.response_mode=t.response_mode,this.skipUserInfo=t.skipUserInfo}toStorageString(){return new E("SigninState").create("toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,url_state:this.url_state,code_verifier:this.code_verifier,authority:this.authority,client_id:this.client_id,redirect_uri:this.redirect_uri,scope:this.scope,client_secret:this.client_secret,extraTokenParams:this.extraTokenParams,response_mode:this.response_mode,skipUserInfo:this.skipUserInfo})}static fromStorageString(t){E.createStatic("SigninState","fromStorageString");const e=JSON.parse(t);return new zt(e)}},Ss=class{constructor({url:t,authority:e,client_id:r,redirect_uri:n,response_type:s,scope:i,state_data:a,response_mode:c,request_type:u,client_secret:o,nonce:d,url_state:h,resource:v,skipUserInfo:m,extraQueryParams:R,extraTokenParams:y,disablePKCE:T,...b}){if(this._logger=new E("SigninRequest"),!t)throw this._logger.error("ctor: No url passed"),new Error("url");if(!r)throw this._logger.error("ctor: No client_id passed"),new Error("client_id");if(!n)throw this._logger.error("ctor: No redirect_uri passed"),new Error("redirect_uri");if(!s)throw this._logger.error("ctor: No response_type passed"),new Error("response_type");if(!i)throw this._logger.error("ctor: No scope passed"),new Error("scope");if(!e)throw this._logger.error("ctor: No authority passed"),new Error("authority");this.state=new zt({data:a,request_type:u,url_state:h,code_verifier:!T,client_id:r,authority:e,redirect_uri:n,response_mode:c,client_secret:o,scope:i,extraTokenParams:y,skipUserInfo:m});const l=new URL(t);l.searchParams.append("client_id",r),l.searchParams.append("redirect_uri",n),l.searchParams.append("response_type",s),l.searchParams.append("scope",i),d&&l.searchParams.append("nonce",d);let g=this.state.id;h&&(g=`${g}${mr}${h}`),l.searchParams.append("state",g),this.state.code_challenge&&(l.searchParams.append("code_challenge",this.state.code_challenge),l.searchParams.append("code_challenge_method","S256")),v&&(Array.isArray(v)?v:[v]).forEach(S=>l.searchParams.append("resource",S));for(const[w,S]of Object.entries({response_mode:c,...b,...R}))S!=null&&l.searchParams.append(w,S.toString());this.url=l.href}},xs="openid",Rt=class{constructor(t){if(this.access_token="",this.token_type="",this.profile={},this.state=t.get("state"),this.session_state=t.get("session_state"),this.state){const e=decodeURIComponent(this.state).split(mr);this.state=e[0],e.length>1&&(this.url_state=e.slice(1).join(mr))}this.error=t.get("error"),this.error_description=t.get("error_description"),this.error_uri=t.get("error_uri"),this.code=t.get("code")}get expires_in(){if(this.expires_at!==void 0)return this.expires_at-ne.getEpochTime()}set expires_in(t){typeof t=="string"&&(t=Number(t)),t!==void 0&&t>=0&&(this.expires_at=Math.floor(t)+ne.getEpochTime())}get isOpenId(){var t;return((t=this.scope)==null?void 0:t.split(" ").includes(xs))||!!this.id_token}},Ts=class{constructor({url:t,state_data:e,id_token_hint:r,post_logout_redirect_uri:n,extraQueryParams:s,request_type:i,client_id:a}){if(this._logger=new E("SignoutRequest"),!t)throw this._logger.error("ctor: No url passed"),new Error("url");const c=new URL(t);r&&c.searchParams.append("id_token_hint",r),a&&c.searchParams.append("client_id",a),n&&(c.searchParams.append("post_logout_redirect_uri",n),e&&(this.state=new $e({data:e,request_type:i}),c.searchParams.append("state",this.state.id)));for(const[u,o]of Object.entries({...s}))o!=null&&c.searchParams.append(u,o.toString());this.url=c.href}},pn=class{constructor(t){this.state=t.get("state"),this.error=t.get("error"),this.error_description=t.get("error_description"),this.error_uri=t.get("error_uri")}},Is=["nbf","jti","auth_time","nonce","acr","amr","azp","at_hash"],Es=["sub","iss","aud","exp","iat"],Cs=class{constructor(t){this._settings=t,this._logger=new E("ClaimsService")}filterProtocolClaims(t){const e={...t};if(this._settings.filterProtocolClaims){let r;Array.isArray(this._settings.filterProtocolClaims)?r=this._settings.filterProtocolClaims:r=Is;for(const n of r)Es.includes(n)||delete e[n]}return e}mergeClaims(t,e){const r={...t};for(const[n,s]of Object.entries(e))for(const i of Array.isArray(s)?s:[s]){const a=r[n];a===void 0?r[n]=i:Array.isArray(a)?a.includes(i)||a.push(i):r[n]!==i&&(typeof i=="object"&&this._settings.mergeClaims?r[n]=this.mergeClaims(a,i):r[n]=[a,i])}return r}},_n=class{constructor(t,e){this._logger=new E("OidcClient"),this.settings=t instanceof Pt?t:new Pt(t),this.metadataService=e??new fn(this.settings),this._claimsService=new Cs(this.settings),this._validator=new ks(this.settings,this.metadataService,this._claimsService),this._tokenClient=new gn(this.settings,this.metadataService)}async createSigninRequest({state:t,request:e,request_uri:r,request_type:n,id_token_hint:s,login_hint:i,skipUserInfo:a,nonce:c,url_state:u,response_type:o=this.settings.response_type,scope:d=this.settings.scope,redirect_uri:h=this.settings.redirect_uri,prompt:v=this.settings.prompt,display:m=this.settings.display,max_age:R=this.settings.max_age,ui_locales:y=this.settings.ui_locales,acr_values:T=this.settings.acr_values,resource:b=this.settings.resource,response_mode:l=this.settings.response_mode,extraQueryParams:g=this.settings.extraQueryParams,extraTokenParams:w=this.settings.extraTokenParams}){const S=this._logger.create("createSigninRequest");if(o!=="code")throw new Error("Only the Authorization Code flow (with PKCE) is supported");const j=await this.metadataService.getAuthorizationEndpoint();S.debug("Received authorization endpoint",j);const A=new Ss({url:j,authority:this.settings.authority,client_id:this.settings.client_id,redirect_uri:h,response_type:o,scope:d,state_data:t,url_state:u,prompt:v,display:m,max_age:R,ui_locales:y,id_token_hint:s,login_hint:i,acr_values:T,resource:b,request:e,request_uri:r,extraQueryParams:g,extraTokenParams:w,request_type:n,response_mode:l,client_secret:this.settings.client_secret,skipUserInfo:a,nonce:c,disablePKCE:this.settings.disablePKCE});await this.clearStaleState();const N=A.state;return await this.settings.stateStore.set(N.id,N.toStorageString()),A}async readSigninResponseState(t,e=!1){const r=this._logger.create("readSigninResponseState"),n=new Rt(_r.readParams(t,this.settings.response_mode));if(!n.state)throw r.throw(new Error("No state in response")),null;const s=await this.settings.stateStore[e?"remove":"get"](n.state);if(!s)throw r.throw(new Error("No matching state found in storage")),null;return{state:zt.fromStorageString(s),response:n}}async processSigninResponse(t){const e=this._logger.create("processSigninResponse"),{state:r,response:n}=await this.readSigninResponseState(t,!0);return e.debug("received state from storage; validating response"),await this._validator.validateSigninResponse(n,r),n}async processResourceOwnerPasswordCredentials({username:t,password:e,skipUserInfo:r=!1,extraTokenParams:n={}}){const s=await this._tokenClient.exchangeCredentials({username:t,password:e,...n}),i=new Rt(new URLSearchParams);return Object.assign(i,s),await this._validator.validateCredentialsResponse(i,r),i}async useRefreshToken({state:t,timeoutInSeconds:e}){var r;const n=this._logger.create("useRefreshToken");let s;if(this.settings.refreshTokenAllowedScope===void 0)s=t.scope;else{const c=this.settings.refreshTokenAllowedScope.split(" ");s=(((r=t.scope)==null?void 0:r.split(" "))||[]).filter(o=>c.includes(o)).join(" ")}const i=await this._tokenClient.exchangeRefreshToken({refresh_token:t.refresh_token,resource:t.resource,scope:s,timeoutInSeconds:e}),a=new Rt(new URLSearchParams);return Object.assign(a,i),n.debug("validating response",a),await this._validator.validateRefreshResponse(a,{...t,scope:s}),a}async createSignoutRequest({state:t,id_token_hint:e,client_id:r,request_type:n,post_logout_redirect_uri:s=this.settings.post_logout_redirect_uri,extraQueryParams:i=this.settings.extraQueryParams}={}){const a=this._logger.create("createSignoutRequest"),c=await this.metadataService.getEndSessionEndpoint();if(!c)throw a.throw(new Error("No end session endpoint")),null;a.debug("Received end session endpoint",c),!r&&s&&!e&&(r=this.settings.client_id);const u=new Ts({url:c,id_token_hint:e,client_id:r,post_logout_redirect_uri:s,state_data:t,extraQueryParams:i,request_type:n});await this.clearStaleState();const o=u.state;return o&&(a.debug("Signout request has state to persist"),await this.settings.stateStore.set(o.id,o.toStorageString())),u}async readSignoutResponseState(t,e=!1){const r=this._logger.create("readSignoutResponseState"),n=new pn(_r.readParams(t,this.settings.response_mode));if(!n.state){if(r.debug("No state in response"),n.error)throw r.warn("Response was error:",n.error),new Re(n);return{state:void 0,response:n}}const s=await this.settings.stateStore[e?"remove":"get"](n.state);if(!s)throw r.throw(new Error("No matching state found in storage")),null;return{state:$e.fromStorageString(s),response:n}}async processSignoutResponse(t){const e=this._logger.create("processSignoutResponse"),{state:r,response:n}=await this.readSignoutResponseState(t,!0);return r?(e.debug("Received state from storage; validating response"),this._validator.validateSignoutResponse(n,r)):e.debug("No state from storage; skipping response validation"),n}clearStaleState(){return this._logger.create("clearStaleState"),$e.clearStaleState(this.settings.stateStore,this.settings.staleStateAgeInSeconds)}async revokeToken(t,e){return this._logger.create("revokeToken"),await this._tokenClient.revoke({token:t,token_type_hint:e})}},mn=class{constructor(t){this._userManager=t,this._logger=new E("SessionMonitor"),this._start=async e=>{const r=e.session_state;if(!r)return;const n=this._logger.create("_start");if(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,n.debug("session_state",r,", sub",this._sub)):(this._sub=void 0,this._sid=void 0,n.debug("session_state",r,", anonymous user")),this._checkSessionIFrame){this._checkSessionIFrame.start(r);return}try{const s=await this._userManager.metadataService.getCheckSessionIframe();if(s){n.debug("initializing check session iframe");const i=this._userManager.settings.client_id,a=this._userManager.settings.checkSessionIntervalInSeconds,c=this._userManager.settings.stopCheckSessionOnError,u=new hn(this._callback,i,s,a,c);await u.load(),this._checkSessionIFrame=u,u.start(r)}else n.warn("no check session iframe found in the metadata")}catch(s){n.error("Error from getCheckSessionIframe:",s instanceof Error?s.message:s)}},this._stop=()=>{const e=this._logger.create("_stop");if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&this._checkSessionIFrame.stop(),this._userManager.settings.monitorAnonymousSession){const r=setInterval(async()=>{clearInterval(r);try{const n=await this._userManager.querySessionStatus();if(n){const s={session_state:n.session_state,profile:n.sub&&n.sid?{sub:n.sub,sid:n.sid}:null};this._start(s)}}catch(n){e.error("error from querySessionStatus",n instanceof Error?n.message:n)}},1e3)}},this._callback=async()=>{const e=this._logger.create("_callback");try{const r=await this._userManager.querySessionStatus();let n=!0;r&&this._checkSessionIFrame?r.sub===this._sub?(n=!1,this._checkSessionIFrame.start(r.session_state),r.sid===this._sid?e.debug("same sub still logged in at OP, restarting check session iframe; session_state",r.session_state):(e.debug("same sub still logged in at OP, session state has changed, restarting check session iframe; session_state",r.session_state),this._userManager.events._raiseUserSessionChanged())):e.debug("different subject signed into OP",r.sub):e.debug("subject no longer signed into OP"),n?this._sub?this._userManager.events._raiseUserSignedOut():this._userManager.events._raiseUserSignedIn():e.debug("no change in session detected, no event to raise")}catch(r){this._sub&&(e.debug("Error calling queryCurrentSigninSession; raising signed out event",r),this._userManager.events._raiseUserSignedOut())}},t||this._logger.throw(new Error("No user manager passed")),this._userManager.events.addUserLoaded(this._start),this._userManager.events.addUserUnloaded(this._stop),this._init().catch(e=>{this._logger.error(e)})}async _init(){this._logger.create("_init");const t=await this._userManager.getUser();if(t)this._start(t);else if(this._userManager.settings.monitorAnonymousSession){const e=await this._userManager.querySessionStatus();if(e){const r={session_state:e.session_state,profile:e.sub&&e.sid?{sub:e.sub,sid:e.sid}:null};this._start(r)}}}},ct=class{constructor(t){var e;this.id_token=t.id_token,this.session_state=(e=t.session_state)!=null?e:null,this.access_token=t.access_token,this.refresh_token=t.refresh_token,this.token_type=t.token_type,this.scope=t.scope,this.profile=t.profile,this.expires_at=t.expires_at,this.state=t.userState,this.url_state=t.url_state}get expires_in(){if(this.expires_at!==void 0)return this.expires_at-ne.getEpochTime()}set expires_in(t){t!==void 0&&(this.expires_at=Math.floor(t)+ne.getEpochTime())}get expired(){const t=this.expires_in;if(t!==void 0)return t<=0}get scopes(){var t,e;return(e=(t=this.scope)==null?void 0:t.split(" "))!=null?e:[]}toStorageString(){return new E("User").create("toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(t){return E.createStatic("User","fromStorageString"),new ct(JSON.parse(t))}},jr="oidc-client",vn=class{constructor(){this._abort=new Ee("Window navigation aborted"),this._disposeHandlers=new Set,this._window=null}async navigate(t){const e=this._logger.create("navigate");if(!this._window)throw new Error("Attempted to navigate on a disposed window");e.debug("setting URL in window"),this._window.location.replace(t.url);const{url:r,keepOpen:n}=await new Promise((s,i)=>{const a=c=>{var u;const o=c.data,d=(u=t.scriptOrigin)!=null?u:window.location.origin;if(!(c.origin!==d||(o==null?void 0:o.source)!==jr)){try{const h=_r.readParams(o.url,t.response_mode).get("state");if(h||e.warn("no state found in response url"),c.source!==this._window&&h!==t.state)return}catch{this._dispose(),i(new Error("Invalid response from window"))}s(o)}};window.addEventListener("message",a,!1),this._disposeHandlers.add(()=>window.removeEventListener("message",a,!1)),this._disposeHandlers.add(this._abort.addHandler(c=>{this._dispose(),i(c)}))});return e.debug("got response from window"),this._dispose(),n||this.close(),{url:r}}_dispose(){this._logger.create("_dispose");for(const t of this._disposeHandlers)t();this._disposeHandlers.clear()}static _notifyParent(t,e,r=!1,n=window.location.origin){t.postMessage({source:jr,url:e,keepOpen:r},n)}},yn={location:!1,toolbar:!1,height:640,closePopupWindowAfterInSeconds:-1},wn="_blank",Os=60,Rs=2,bn=10,kn=class extends Pt{constructor(t){const{popup_redirect_uri:e=t.redirect_uri,popup_post_logout_redirect_uri:r=t.post_logout_redirect_uri,popupWindowFeatures:n=yn,popupWindowTarget:s=wn,redirectMethod:i="assign",redirectTarget:a="self",iframeNotifyParentOrigin:c=t.iframeNotifyParentOrigin,iframeScriptOrigin:u=t.iframeScriptOrigin,silent_redirect_uri:o=t.redirect_uri,silentRequestTimeoutInSeconds:d=bn,automaticSilentRenew:h=!0,validateSubOnSilentRenew:v=!0,includeIdTokenInSilentRenew:m=!1,monitorSession:R=!1,monitorAnonymousSession:y=!1,checkSessionIntervalInSeconds:T=Rs,query_status_response_type:b="code",stopCheckSessionOnError:l=!0,revokeTokenTypes:g=["access_token","refresh_token"],revokeTokensOnSignout:w=!1,includeIdTokenInSilentSignout:S=!1,accessTokenExpiringNotificationTimeInSeconds:j=Os,userStore:A}=t;if(super(t),this.popup_redirect_uri=e,this.popup_post_logout_redirect_uri=r,this.popupWindowFeatures=n,this.popupWindowTarget=s,this.redirectMethod=i,this.redirectTarget=a,this.iframeNotifyParentOrigin=c,this.iframeScriptOrigin=u,this.silent_redirect_uri=o,this.silentRequestTimeoutInSeconds=d,this.automaticSilentRenew=h,this.validateSubOnSilentRenew=v,this.includeIdTokenInSilentRenew=m,this.monitorSession=R,this.monitorAnonymousSession=y,this.checkSessionIntervalInSeconds=T,this.stopCheckSessionOnError=l,this.query_status_response_type=b,this.revokeTokenTypes=g,this.revokeTokensOnSignout=w,this.includeIdTokenInSilentSignout=S,this.accessTokenExpiringNotificationTimeInSeconds=j,A)this.userStore=A;else{const N=typeof window<"u"?window.sessionStorage:new Tr;this.userStore=new Er({store:N})}}},vr=class extends vn{constructor({silentRequestTimeoutInSeconds:t=bn}){super(),this._logger=new E("IFrameWindow"),this._timeoutInSeconds=t,this._frame=vr.createHiddenIframe(),this._window=this._frame.contentWindow}static createHiddenIframe(){const t=window.document.createElement("iframe");return t.style.visibility="hidden",t.style.position="fixed",t.style.left="-1000px",t.style.top="0",t.width="0",t.height="0",window.document.body.appendChild(t),t}async navigate(t){this._logger.debug("navigate: Using timeout of:",this._timeoutInSeconds);const e=setTimeout(()=>this._abort.raise(new Wt("IFrame timed out without a response")),this._timeoutInSeconds*1e3);return this._disposeHandlers.add(()=>clearTimeout(e)),await super.navigate(t)}close(){var t;this._frame&&(this._frame.parentNode&&(this._frame.addEventListener("load",e=>{var r;const n=e.target;(r=n.parentNode)==null||r.removeChild(n),this._abort.raise(new Error("IFrame removed from DOM"))},!0),(t=this._frame.contentWindow)==null||t.location.replace("about:blank")),this._frame=null),this._window=null}static notifyParent(t,e){return super._notifyParent(window.parent,t,!1,e)}},Us=class{constructor(t){this._settings=t,this._logger=new E("IFrameNavigator")}async prepare({silentRequestTimeoutInSeconds:t=this._settings.silentRequestTimeoutInSeconds}){return new vr({silentRequestTimeoutInSeconds:t})}async callback(t){this._logger.create("callback"),vr.notifyParent(t,this._settings.iframeNotifyParentOrigin)}},Ps=500,As=1e3,Mr=class extends vn{constructor({popupWindowTarget:t=wn,popupWindowFeatures:e={}}){super(),this._logger=new E("PopupWindow");const r=Ar.center({...yn,...e});this._window=window.open(void 0,t,Ar.serialize(r)),e.closePopupWindowAfterInSeconds&&e.closePopupWindowAfterInSeconds>0&&setTimeout(()=>{if(!this._window||typeof this._window.closed!="boolean"||this._window.closed){this._abort.raise(new Error("Popup blocked by user"));return}this.close()},e.closePopupWindowAfterInSeconds*As)}async navigate(t){var e;(e=this._window)==null||e.focus();const r=setInterval(()=>{(!this._window||this._window.closed)&&this._abort.raise(new Error("Popup closed by user"))},Ps);return this._disposeHandlers.add(()=>clearInterval(r)),await super.navigate(t)}close(){this._window&&(this._window.closed||(this._window.close(),this._abort.raise(new Error("Popup closed")))),this._window=null}static notifyOpener(t,e){if(!window.opener)throw new Error("No window.opener. Can't complete notification.");return super._notifyParent(window.opener,t,e)}},js=class{constructor(t){this._settings=t,this._logger=new E("PopupNavigator")}async prepare({popupWindowFeatures:t=this._settings.popupWindowFeatures,popupWindowTarget:e=this._settings.popupWindowTarget}){return new Mr({popupWindowFeatures:t,popupWindowTarget:e})}async callback(t,{keepOpen:e=!1}){this._logger.create("callback"),Mr.notifyOpener(t,e)}},Ms=class{constructor(t){this._settings=t,this._logger=new E("RedirectNavigator")}async prepare({redirectMethod:t=this._settings.redirectMethod,redirectTarget:e=this._settings.redirectTarget}){var r;this._logger.create("prepare");let n=window.self;e==="top"&&(n=(r=window.top)!=null?r:window.self);const s=n.location[t].bind(n.location);let i;return{navigate:async a=>{this._logger.create("navigate");const c=new Promise((u,o)=>{i=o});return s(a.url),await c},close:()=>{this._logger.create("close"),i==null||i(new Error("Redirect aborted")),n.stop()}}}async callback(){}},Ns=class extends ln{constructor(t){super({expiringNotificationTimeInSeconds:t.accessTokenExpiringNotificationTimeInSeconds}),this._logger=new E("UserManagerEvents"),this._userLoaded=new Ee("User loaded"),this._userUnloaded=new Ee("User unloaded"),this._silentRenewError=new Ee("Silent renew error"),this._userSignedIn=new Ee("User signed in"),this._userSignedOut=new Ee("User signed out"),this._userSessionChanged=new Ee("User session changed")}load(t,e=!0){super.load(t),e&&this._userLoaded.raise(t)}unload(){super.unload(),this._userUnloaded.raise()}addUserLoaded(t){return this._userLoaded.addHandler(t)}removeUserLoaded(t){return this._userLoaded.removeHandler(t)}addUserUnloaded(t){return this._userUnloaded.addHandler(t)}removeUserUnloaded(t){return this._userUnloaded.removeHandler(t)}addSilentRenewError(t){return this._silentRenewError.addHandler(t)}removeSilentRenewError(t){return this._silentRenewError.removeHandler(t)}_raiseSilentRenewError(t){this._silentRenewError.raise(t)}addUserSignedIn(t){return this._userSignedIn.addHandler(t)}removeUserSignedIn(t){this._userSignedIn.removeHandler(t)}_raiseUserSignedIn(){this._userSignedIn.raise()}addUserSignedOut(t){return this._userSignedOut.addHandler(t)}removeUserSignedOut(t){this._userSignedOut.removeHandler(t)}_raiseUserSignedOut(){this._userSignedOut.raise()}addUserSessionChanged(t){return this._userSessionChanged.addHandler(t)}removeUserSessionChanged(t){this._userSessionChanged.removeHandler(t)}_raiseUserSessionChanged(){this._userSessionChanged.raise()}},Ls=class{constructor(t){this._userManager=t,this._logger=new E("SilentRenewService"),this._isStarted=!1,this._retryTimer=new ne("Retry Silent Renew"),this._tokenExpiring=async()=>{const e=this._logger.create("_tokenExpiring");try{await this._userManager.signinSilent(),e.debug("silent token renewal successful")}catch(r){if(r instanceof Wt){e.warn("ErrorTimeout from signinSilent:",r,"retry in 5s"),this._retryTimer.init(5);return}e.error("Error from signinSilent:",r),this._userManager.events._raiseSilentRenewError(r)}}}async start(){const t=this._logger.create("start");if(!this._isStarted){this._isStarted=!0,this._userManager.events.addAccessTokenExpiring(this._tokenExpiring),this._retryTimer.addHandler(this._tokenExpiring);try{await this._userManager.getUser()}catch(e){t.error("getUser error",e)}}}stop(){this._isStarted&&(this._retryTimer.cancel(),this._retryTimer.removeHandler(this._tokenExpiring),this._userManager.events.removeAccessTokenExpiring(this._tokenExpiring),this._isStarted=!1)}},Zs=class{constructor(t,e){this.refresh_token=t.refresh_token,this.id_token=t.id_token,this.session_state=t.session_state,this.scope=t.scope,this.profile=t.profile,this.resource=e,this.data=t.state}},$s=class{constructor(t,e,r,n){this._logger=new E("UserManager"),this.settings=new kn(t),this._client=new _n(t),this._redirectNavigator=e??new Ms(this.settings),this._popupNavigator=r??new js(this.settings),this._iframeNavigator=n??new Us(this.settings),this._events=new Ns(this.settings),this._silentRenewService=new Ls(this),this.settings.automaticSilentRenew&&this.startSilentRenew(),this._sessionMonitor=null,this.settings.monitorSession&&(this._sessionMonitor=new mn(this))}get events(){return this._events}get metadataService(){return this._client.metadataService}async getUser(){const t=this._logger.create("getUser"),e=await this._loadUser();return e?(t.info("user loaded"),this._events.load(e,!1),e):(t.info("user not found in storage"),null)}async removeUser(){const t=this._logger.create("removeUser");await this.storeUser(null),t.info("user removed from storage"),this._events.unload()}async signinRedirect(t={}){this._logger.create("signinRedirect");const{redirectMethod:e,...r}=t,n=await this._redirectNavigator.prepare({redirectMethod:e});await this._signinStart({request_type:"si:r",...r},n)}async signinRedirectCallback(t=window.location.href){const e=this._logger.create("signinRedirectCallback"),r=await this._signinEnd(t);return r.profile&&r.profile.sub?e.info("success, signed in subject",r.profile.sub):e.info("no subject"),r}async signinResourceOwnerCredentials({username:t,password:e,skipUserInfo:r=!1}){const n=this._logger.create("signinResourceOwnerCredential"),s=await this._client.processResourceOwnerPasswordCredentials({username:t,password:e,skipUserInfo:r,extraTokenParams:this.settings.extraTokenParams});n.debug("got signin response");const i=await this._buildUser(s);return i.profile&&i.profile.sub?n.info("success, signed in subject",i.profile.sub):n.info("no subject"),i}async signinPopup(t={}){const e=this._logger.create("signinPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...s}=t,i=this.settings.popup_redirect_uri;i||e.throw(new Error("No popup_redirect_uri configured"));const a=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n}),c=await this._signin({request_type:"si:p",redirect_uri:i,display:"popup",...s},a);return c&&(c.profile&&c.profile.sub?e.info("success, signed in subject",c.profile.sub):e.info("no subject")),c}async signinPopupCallback(t=window.location.href,e=!1){const r=this._logger.create("signinPopupCallback");await this._popupNavigator.callback(t,{keepOpen:e}),r.info("success")}async signinSilent(t={}){var e;const r=this._logger.create("signinSilent"),{silentRequestTimeoutInSeconds:n,resource:s,...i}=t;let a=await this._loadUser();if(a!=null&&a.refresh_token){r.debug("using refresh token");const d=new Zs(a,s);return await this._useRefreshToken(d)}const c=this.settings.silent_redirect_uri;c||r.throw(new Error("No silent_redirect_uri configured"));let u;a&&this.settings.validateSubOnSilentRenew&&(r.debug("subject prior to silent renew:",a.profile.sub),u=a.profile.sub);const o=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});return a=await this._signin({request_type:"si:s",redirect_uri:c,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?a==null?void 0:a.id_token:void 0,...i},o,u),a&&((e=a.profile)!=null&&e.sub?r.info("success, signed in subject",a.profile.sub):r.info("no subject")),a}async _useRefreshToken(t){const e=await this._client.useRefreshToken({state:t,timeoutInSeconds:this.settings.silentRequestTimeoutInSeconds}),r=new ct({...t,...e});return await this.storeUser(r),this._events.load(r),r}async signinSilentCallback(t=window.location.href){const e=this._logger.create("signinSilentCallback");await this._iframeNavigator.callback(t),e.info("success")}async signinCallback(t=window.location.href){const{state:e}=await this._client.readSigninResponseState(t);switch(e.request_type){case"si:r":return await this.signinRedirectCallback(t);case"si:p":return await this.signinPopupCallback(t);case"si:s":return await this.signinSilentCallback(t);default:throw new Error("invalid response_type in state")}}async signoutCallback(t=window.location.href,e=!1){const{state:r}=await this._client.readSignoutResponseState(t);if(r)switch(r.request_type){case"so:r":await this.signoutRedirectCallback(t);break;case"so:p":await this.signoutPopupCallback(t,e);break;case"so:s":await this.signoutSilentCallback(t);break;default:throw new Error("invalid response_type in state")}}async querySessionStatus(t={}){const e=this._logger.create("querySessionStatus"),{silentRequestTimeoutInSeconds:r,...n}=t,s=this.settings.silent_redirect_uri;s||e.throw(new Error("No silent_redirect_uri configured"));const i=await this._loadUser(),a=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:r}),c=await this._signinStart({request_type:"si:s",redirect_uri:s,prompt:"none",id_token_hint:this.settings.includeIdTokenInSilentRenew?i==null?void 0:i.id_token:void 0,response_type:this.settings.query_status_response_type,scope:"openid",skipUserInfo:!0,...n},a);try{const u=await this._client.processSigninResponse(c.url);return e.debug("got signin response"),u.session_state&&u.profile.sub?(e.info("success for subject",u.profile.sub),{session_state:u.session_state,sub:u.profile.sub,sid:u.profile.sid}):(e.info("success, user not authenticated"),null)}catch(u){if(this.settings.monitorAnonymousSession&&u instanceof Re)switch(u.error){case"login_required":case"consent_required":case"interaction_required":case"account_selection_required":return e.info("success for anonymous user"),{session_state:u.session_state}}throw u}}async _signin(t,e,r){const n=await this._signinStart(t,e);return await this._signinEnd(n.url,r)}async _signinStart(t,e){const r=this._logger.create("_signinStart");try{const n=await this._client.createSigninRequest(t);return r.debug("got signin request"),await e.navigate({url:n.url,state:n.state.id,response_mode:n.state.response_mode,scriptOrigin:this.settings.iframeScriptOrigin})}catch(n){throw r.debug("error after preparing navigator, closing navigator window"),e.close(),n}}async _signinEnd(t,e){const r=this._logger.create("_signinEnd"),n=await this._client.processSigninResponse(t);return r.debug("got signin response"),await this._buildUser(n,e)}async _buildUser(t,e){const r=this._logger.create("_buildUser"),n=new ct(t);if(e){if(e!==n.profile.sub)throw r.debug("current user does not match user returned from signin. sub from signin:",n.profile.sub),new Re({...t,error:"login_required"});r.debug("current user matches user returned from signin")}return await this.storeUser(n),r.debug("user stored"),this._events.load(n),n}async signoutRedirect(t={}){const e=this._logger.create("signoutRedirect"),{redirectMethod:r,...n}=t,s=await this._redirectNavigator.prepare({redirectMethod:r});await this._signoutStart({request_type:"so:r",post_logout_redirect_uri:this.settings.post_logout_redirect_uri,...n},s),e.info("success")}async signoutRedirectCallback(t=window.location.href){const e=this._logger.create("signoutRedirectCallback"),r=await this._signoutEnd(t);return e.info("success"),r}async signoutPopup(t={}){const e=this._logger.create("signoutPopup"),{popupWindowFeatures:r,popupWindowTarget:n,...s}=t,i=this.settings.popup_post_logout_redirect_uri,a=await this._popupNavigator.prepare({popupWindowFeatures:r,popupWindowTarget:n});await this._signout({request_type:"so:p",post_logout_redirect_uri:i,state:i==null?void 0:{},...s},a),e.info("success")}async signoutPopupCallback(t=window.location.href,e=!1){const r=this._logger.create("signoutPopupCallback");await this._popupNavigator.callback(t,{keepOpen:e}),r.info("success")}async _signout(t,e){const r=await this._signoutStart(t,e);return await this._signoutEnd(r.url)}async _signoutStart(t={},e){var r;const n=this._logger.create("_signoutStart");try{const s=await this._loadUser();n.debug("loaded current user from storage"),this.settings.revokeTokensOnSignout&&await this._revokeInternal(s);const i=t.id_token_hint||s&&s.id_token;i&&(n.debug("setting id_token_hint in signout request"),t.id_token_hint=i),await this.removeUser(),n.debug("user removed, creating signout request");const a=await this._client.createSignoutRequest(t);return n.debug("got signout request"),await e.navigate({url:a.url,state:(r=a.state)==null?void 0:r.id,scriptOrigin:this.settings.iframeScriptOrigin})}catch(s){throw n.debug("error after preparing navigator, closing navigator window"),e.close(),s}}async _signoutEnd(t){const e=this._logger.create("_signoutEnd"),r=await this._client.processSignoutResponse(t);return e.debug("got signout response"),r}async signoutSilent(t={}){var e;const r=this._logger.create("signoutSilent"),{silentRequestTimeoutInSeconds:n,...s}=t,i=this.settings.includeIdTokenInSilentSignout?(e=await this._loadUser())==null?void 0:e.id_token:void 0,a=this.settings.popup_post_logout_redirect_uri,c=await this._iframeNavigator.prepare({silentRequestTimeoutInSeconds:n});await this._signout({request_type:"so:s",post_logout_redirect_uri:a,id_token_hint:i,...s},c),r.info("success")}async signoutSilentCallback(t=window.location.href){const e=this._logger.create("signoutSilentCallback");await this._iframeNavigator.callback(t),e.info("success")}async revokeTokens(t){const e=await this._loadUser();await this._revokeInternal(e,t)}async _revokeInternal(t,e=this.settings.revokeTokenTypes){const r=this._logger.create("_revokeInternal");if(!t)return;const n=e.filter(s=>typeof t[s]=="string");if(!n.length){r.debug("no need to revoke due to no token(s)");return}for(const s of n)await this._client.revokeToken(t[s],s),r.info(`${s} revoked successfully`),s!=="access_token"&&(t[s]=null);await this.storeUser(t),r.debug("user stored"),this._events.load(t)}startSilentRenew(){this._logger.create("startSilentRenew"),this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return`user:${this.settings.authority}:${this.settings.client_id}`}async _loadUser(){const t=this._logger.create("_loadUser"),e=await this.settings.userStore.get(this._userStoreKey);return e?(t.debug("user storageString loaded"),ct.fromStorageString(e)):(t.debug("no user storageString"),null)}async storeUser(t){const e=this._logger.create("storeUser");if(t){e.debug("storing user");const r=t.toStorageString();await this.settings.userStore.set(this._userStoreKey,r)}else this._logger.debug("removing user"),await this.settings.userStore.remove(this._userStoreKey)}async clearStaleState(){await this._client.clearStaleState()}},Ds="2.4.0",qs=Ds,Vt={},Hs=I&&I.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.readExpirationTimeInJwt=void 0;var Bs=Hs(xr),Ws=St();function zs(t){var e;try{e=(0,Bs.default)(t).exp*1e3,(0,Ws.assert)(typeof e=="number"&&!isNaN(e))}catch{return}return e}Vt.readExpirationTimeInJwt=zs;var Oe={},Nr=I&&I.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],a;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(c){a={error:c}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.retrieveQueryParamFromUrl=Oe.retrieveAllQueryParamStartingWithPrefixFromUrl=Oe.addQueryParamToUrl=void 0;function Vs(t){var e=t.url,r=t.name,n=t.value,s=e,i=xn({url:e,name:r});return i.wasPresent&&(s=i.newUrl),s+="".concat(s.includes("?")?"&":s.endsWith("?")?"":"?").concat(r,"=").concat(encodeURIComponent(n)),{newUrl:s}}Oe.addQueryParamToUrl=Vs;function Sn(t){var e=t.url,r=t.prefix,n=t.doLeavePrefixInResults,s=Nr(e.split("?"),2),i=s[0],a=s[1],c=a===void 0?"":a,u={},o=function(){var d=c.replace(/^\?/,"").split("&").map(function(h){return h.split("=")}).filter(function(h){var v=Nr(h,2),m=v[0],R=v[1];return m.startsWith(r)?(u[n?m:m.substring(r.length)]=decodeURIComponent(R),!1):!0}).map(function(h){return h.join("=")}).join("&");return d=d===""?"":"?".concat(d),{newLocationSearch:d}}().newLocationSearch;return{newUrl:"".concat(i).concat(o),values:u}}Oe.retrieveAllQueryParamStartingWithPrefixFromUrl=Sn;function xn(t){var e=t.url,r=t.name,n=Sn({url:e,prefix:r,doLeavePrefixInResults:!0}),s=n.newUrl,i=n.values;return r in i?{wasPresent:!0,newUrl:s,value:i[r]}:{wasPresent:!1}}Oe.retrieveQueryParamFromUrl=xn;var Ft={};Object.defineProperty(Ft,"__esModule",{value:!0});Ft.fnv1aHashToHex=void 0;function Fs(t){for(var e=2166136261,r=0;r<t.length;r++)e^=t.charCodeAt(r),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return(e>>>0).toString(16)}Ft.fnv1aHashToHex=Fs;var De={},Js=I&&I.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(De,"__esModule",{value:!0});De.VoidDeferred=De.Deferred=void 0;var Lr=Hn(),Tn=function(){function t(){var e=this;this.isPending=!0;var r,n;this.pr=new Promise(function(s,i){r=function(a){(0,Lr.overwriteReadonlyProp)(e,"isPending",!1),s(a)},n=function(a){(0,Lr.overwriteReadonlyProp)(e,"isPending",!1),i(a)}}),this.resolve=r,this.reject=n}return t}();De.Deferred=Tn;var Ks=function(t){Js(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Tn);De.VoidDeferred=Ks;var Jt={},Qs=I&&I.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.decodeJwt=void 0;var Gs=Qs(xr);Jt.decodeJwt=Gs.default;var Kt={},Ys=I&&I.__values||function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.getDownlinkAndRtt=void 0;var Zr=St();function Xs(){var t,e;if(window.navigator instanceof Object){var r=window.navigator;try{for(var n=Ys(["connection","mozConnection","webkitConnection"]),s=n.next();!s.done;s=n.next()){var i=s.value;try{var a=r[i],c=a.downlink,u=a.rtt;return(0,Zr.assert)(typeof c=="number"),(0,Zr.assert)(typeof u=="number"),{downlink:c,rtt:u}}catch{}}}catch(o){t={error:o}}finally{try{s&&!s.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}}}Kt.getDownlinkAndRtt=Xs;var Qt={},Gt={};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.createStatefulObservable=void 0;function ei(t){var e=[],r=function(){var i=void 0;return{get:function(){return i===void 0&&(i=[t()]),i[0]},set:function(a){i=[a],e.forEach(function(c){return c(a)})}}}(),n=r.get,s=r.set;return Object.defineProperty({current:null,subscribe:function(i){return e.push(i),{unsubscribe:function(){return e.splice(e.indexOf(i),1)}}}},"current",{enumerable:!0,get:n,set:s})}Gt.createStatefulObservable=ei;var Yt={},Xt={};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.getPrUserInteraction=void 0;var ti=De;function ri(){var t=new ti.Deferred,e=function(){t.resolve(),r()},r=function(){window.document.removeEventListener("mousemove",e,!1),window.document.removeEventListener("keydown",e,!1)};return window.document.addEventListener("mousemove",e,!1),window.document.addEventListener("keydown",e,!1),{prUserInteraction:t.pr,cancelPrUserInteraction:r}}Xt.getPrUserInteraction=ri;const ni=t=>(e,r)=>(t.set(e,r),r),$r=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,In=536870912,Dr=In*2,si=(t,e)=>r=>{const n=e.get(r);let s=n===void 0?r.size:n<Dr?n+1:0;if(!r.has(s))return t(r,s);if(r.size<In){for(;r.has(s);)s=Math.floor(Math.random()*Dr);return t(r,s)}if(r.size>$r)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(s);)s=Math.floor(Math.random()*$r);return t(r,s)},En=new WeakMap,ii=ni(En),Ot=si(ii,En),ai=t=>t.method!==void 0&&t.method==="call",oi=t=>t.error===null&&typeof t.id=="number",ci=t=>{const e=new Map([[0,()=>{}]]),r=new Map([[0,()=>{}]]),n=new Map,s=new Worker(t);return s.addEventListener("message",({data:o})=>{if(ai(o)){const{params:{timerId:d,timerType:h}}=o;if(h==="interval"){const v=e.get(d);if(typeof v=="number"){const m=n.get(v);if(m===void 0||m.timerId!==d||m.timerType!==h)throw new Error("The timer is in an undefined state.")}else if(typeof v<"u")v();else throw new Error("The timer is in an undefined state.")}else if(h==="timeout"){const v=r.get(d);if(typeof v=="number"){const m=n.get(v);if(m===void 0||m.timerId!==d||m.timerType!==h)throw new Error("The timer is in an undefined state.")}else if(typeof v<"u")v(),r.delete(d);else throw new Error("The timer is in an undefined state.")}}else if(oi(o)){const{id:d}=o,h=n.get(d);if(h===void 0)throw new Error("The timer is in an undefined state.");const{timerId:v,timerType:m}=h;n.delete(d),m==="interval"?e.delete(v):r.delete(v)}else{const{error:{message:d}}=o;throw new Error(d)}}),{clearInterval:o=>{const d=Ot(n);n.set(d,{timerId:o,timerType:"interval"}),e.set(o,d),s.postMessage({id:d,method:"clear",params:{timerId:o,timerType:"interval"}})},clearTimeout:o=>{const d=Ot(n);n.set(d,{timerId:o,timerType:"timeout"}),r.set(o,d),s.postMessage({id:d,method:"clear",params:{timerId:o,timerType:"timeout"}})},setInterval:(o,d=0)=>{const h=Ot(e);return e.set(h,()=>{o(),typeof e.get(h)=="function"&&s.postMessage({id:null,method:"set",params:{delay:d,now:performance.now(),timerId:h,timerType:"interval"}})}),s.postMessage({id:null,method:"set",params:{delay:d,now:performance.now(),timerId:h,timerType:"interval"}}),h},setTimeout:(o,d=0)=>{const h=Ot(r);return r.set(h,o),s.postMessage({id:null,method:"set",params:{delay:d,now:performance.now(),timerId:h,timerType:"timeout"}}),h}}},di=(t,e)=>{let r=null;return()=>{if(r!==null)return r;const n=new Blob([e],{type:"application/javascript; charset=utf-8"}),s=URL.createObjectURL(n);return r=t(s),setTimeout(()=>URL.revokeObjectURL(s)),r}},ui=`(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error('There is no interval scheduled with the given id "'.concat(t,'".'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error('The given type "'.concat(i,'" is not supported'));(e=>{const r=t.get(e);if(void 0===r)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error('The given method "'.concat(s.method,'" is not supported'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error('The given type "'.concat(d,'" is not supported'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();`,er=di(ci,ui),li=t=>er().clearInterval(t),hi=t=>er().clearTimeout(t),fi=(...t)=>er().setInterval(...t),gi=(...t)=>er().setTimeout(...t),pi=Object.freeze(Object.defineProperty({__proto__:null,clearInterval:li,clearTimeout:hi,setInterval:fi,setTimeout:gi},Symbol.toStringTag,{value:"Module"})),tr=Sr(pi);var _i=I&&I.__awaiter||function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function c(d){try{o(n.next(d))}catch(h){a(h)}}function u(d){try{o(n.throw(d))}catch(h){a(h)}}function o(d){d.done?i(d.value):s(d.value).then(c,u)}o((n=n.apply(t,e||[])).next())})},mi=I&&I.__generator||function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(o){return function(d){return u([o,d])}}function u(o){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(r=0)),r;)try{if(n=1,s&&(i=o[0]&2?s.return:o[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,o[1])).done)return i;switch(s=0,i&&(o=[o[0]&2,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,s=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(d){o=[6,d],s=0}finally{n=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.subscribeToUserInteraction=void 0;var vi=Xt,qr=tr;function yi(t){var e=t.throttleMs,r=new Set;(function s(){return _i(this,void 0,void 0,function(){var i,a,c;return mi(this,function(u){switch(u.label){case 0:return i=(0,vi.getPrUserInteraction)(),a=i.cancelPrUserInteraction,c=i.prUserInteraction,r.add(a),[4,c];case 1:return u.sent(),t.callback(),[4,new Promise(function(o){var d=(0,qr.setTimeout)(o,e);r.add(function(){(0,qr.clearTimeout)(d)})})];case 2:return u.sent(),r.clear(),s(),[2]}})})})();var n=function(){Array.from(r).forEach(function(s){return s()})};return{unsubscribeFromUserInteraction:n}}Yt.subscribeToUserInteraction=yi;Object.defineProperty(Qt,"__esModule",{value:!0});Qt.createIsUserActive=void 0;var wi=Gt,bi=Yt,ki=St(),Hr=tr;function Si(t){var e=t.theUserIsConsideredInactiveAfterMsOfInactivity,r=(0,wi.createStatefulObservable)(function(){return!0}),n=function(){var c=(0,Hr.setTimeout)(function(){(0,ki.assert)(r.current),r.current=!1},e);return function(){(0,Hr.clearTimeout)(c)}},s=n(),i=(0,bi.subscribeToUserInteraction)({throttleMs:1e3,callback:function(){s(),s=n(),r.current||(r.current=!0)}}).unsubscribeFromUserInteraction,a=function(){i(),s()};return{$isUserActive:r,disable$isUserActive:a}}Qt.createIsUserActive=Si;var rr={},xi=I&&I.__awaiter||function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function c(d){try{o(n.next(d))}catch(h){a(h)}}function u(d){try{o(n.throw(d))}catch(h){a(h)}}function o(d){d.done?i(d.value):s(d.value).then(c,u)}o((n=n.apply(t,e||[])).next())})},Ti=I&&I.__generator||function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(o){return function(d){return u([o,d])}}function u(o){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(r=0)),r;)try{if(n=1,s&&(i=o[0]&2?s.return:o[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,o[1])).done)return i;switch(s=0,i&&(o=[o[0]&2,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,s=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(d){o=[6,d],s=0}finally{n=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(rr,"__esModule",{value:!0});rr.createStartCountdown=void 0;var Br=tr;function Ii(t){var e=t.getCountdownEndTime,r=t.tickCallback,n=function(){return e()-Date.now()};function s(){var i=this,a;(function(){return xi(i,void 0,void 0,function(){var u;return Ti(this,function(o){switch(o.label){case 0:u=Math.floor(n()/1e3),o.label=1;case 1:return u>=0?(r({secondsLeft:u}),[4,new Promise(function(d){a=(0,Br.setTimeout)(d,1e3)})]):[3,3];case 2:return o.sent(),u--,[3,1];case 3:return[2]}})})})();var c=function(){(0,Br.clearTimeout)(a),r({secondsLeft:void 0})};return{stopCountdown:c}}return{startCountdown:s}}rr.createStartCountdown=Ii;var Ei=I&&I.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ge=I&&I.__assign||function(){return ge=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},ge.apply(this,arguments)},we=I&&I.__awaiter||function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function c(d){try{o(n.next(d))}catch(h){a(h)}}function u(d){try{o(n.throw(d))}catch(h){a(h)}}function o(d){d.done?i(d.value):s(d.value).then(c,u)}o((n=n.apply(t,e||[])).next())})},be=I&&I.__generator||function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(o){return function(d){return u([o,d])}}function u(o){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(r=0)),r;)try{if(n=1,s&&(i=o[0]&2?s.return:o[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,o[1])).done)return i;switch(s=0,i&&(o=[o[0]&2,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,s=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1],i=o;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(o);break}i[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(d){o=[6,d],s=0}finally{n=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},or=I&&I.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],a;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(c){a={error:c}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Wr=I&&I.__spreadArray||function(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))},zr=I&&I.__values||function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(rt,"__esModule",{value:!0});rt.createOidc=rt.OidcInitializationError=void 0;var Ci=cs,cr=tn,Vr=Vt,X=St(),le=Oe,Oi=Ft,Ri=De,Ui=Jt,Pi=Kt,Ai=Qt,ji=rr,ot=tr,ke=function(t){Ei(e,t);function e(r){var n=this.constructor,s=t.call(this,function(){switch(r.type){case"server down":return["The OIDC server seems to be down.","If you know it's not the case it means that the issuerUri: ".concat(r.issuerUri," is incorrect."),`If you are using Keycloak makes sure that the realm exists and that the url is well formed.
`,"More info: https://docs.oidc-spa.dev/resources/usage-with-keycloak"].join(" ");case"bad configuration":switch(r.likelyCause.type){case"misconfigured OIDC client":return["The OIDC client ".concat(r.likelyCause.clientId," seems to be misconfigured on your OIDC server."),'If you are using Keycloak you likely need to add "'.concat(location.origin,'/*" to the list of Valid Redirect URIs'),"in the ".concat(r.likelyCause.clientId,` client configuration.
`),"More info: https://docs.oidc-spa.dev/resources/usage-with-keycloak","Silent SSO timed out after ".concat(r.likelyCause.timeoutDelayMs,"ms.")].join(" ");case"not in Web Origins":return["It seems that there is a CORS issue.",'If you are using Keycloak check the "Web Origins" option in your '.concat(r.likelyCause.clientId," client configuration."),'You should probably add "'.concat(location.origin,'/*" to the list.'),"More info: https://docs.oidc-spa.dev/resources/usage-with-keycloak"].join(" ");case"silent-sso.html not reachable":return["".concat(r.likelyCause.silentSsoHtmlUrl," is not reachable. Make sure you've created the silent-sso.html file"),"in your public directory. More info: https://docs.oidc-spa.dev/documentation/installation"].join(" ")}case"unknown":return r.cause.message}(0,X.assert)(!1)}(),{cause:r.type==="unknown"?r.cause:void 0})||this;return s.type=r.type,Object.setPrototypeOf(s,n.prototype),s}return e}(Error);rt.OidcInitializationError=ke;var Fr=["code","state","session_state","iss"],dr=void 0,ur=new Map,lr=window.URL;function Mi(t){return we(this,void 0,void 0,function(){var e,r,n,s,i,a,c,u,o,d,h,v,m,R,y,T,b,l,g,w,S,j,A,N,Z,K,D,re,de,ve,je,We,Q,ze,ir,It=this;return be(this,function(Cr){switch(Cr.label){case 0:return e=t.issuerUri,r=t.clientId,n=t.clientSecret,s=t.transformUrlBeforeRedirect,i=s===void 0?function(U){return U}:s,a=t.extraQueryParams,c=t.publicUrl,u=t.decodedIdTokenSchema,o=t.__unsafe_ssoSessionIdleSeconds,d=t.autoLogoutParams,h=d===void 0?{redirectTo:"current page"}:d,v=function(){if(typeof a=="function")return a;if(a!==void 0)return function(){return a}}(),m=function(){return c===void 0?window.location.origin:(c.startsWith("http")?c:"".concat(window.location.origin).concat(c)).replace(/\/$/,"")}(),R=(0,Oi.fnv1aHashToHex)("".concat(e," ").concat(r)),y=ur.get(R),y!==void 0&&Array.from(y??[]).forEach(function(U){return U()}),ur.set(R,new Set),T="configHash",b="".concat(m,"/silent-sso.html"),l=new Ci.UserManager({authority:e,client_id:r,client_secret:n,redirect_uri:"",response_type:"code",scope:"openid profile",automaticSilentRenew:!1,silent_redirect_uri:"".concat(b,"?").concat(T,"=").concat(R)}),g=void 0,w=function(){var U=history.pushState.bind(history);history.pushState=function(){for(var H=[],q=0;q<arguments.length;q++)H[q]=arguments[q];return g=window.location.href,U.apply(void 0,Wr([],or(H),!1))}},S=!1,j=function(U){var L=U.doesCurrentHrefRequiresAuth,H=U.extraQueryParams;return we(It,void 0,void 0,function(){var q,ee,V;return be(this,function(B){switch(B.label){case 0:return S?[2,new Promise(function(){})]:(S=!0,q=(0,le.addQueryParamToUrl)({url:window.location.href,name:T,value:R}).newUrl,ee=function(){document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",ee),L?g!==void 0?window.location.href=g:window.history.back():S=!1)},document.addEventListener("visibilitychange",ee),V=function(){for(var Ve=[],Te=0;Te<arguments.length;Te++)Ve[Te]=arguments[Te];var se=new(lr.bind.apply(lr,Wr([void 0],or(Ve),!1)));return new Proxy(se,{get:function(Fe,Je){if(Je==="href"){var ye=se.href;return Object.entries(ge(ge({},v==null?void 0:v()),H)).forEach(function(ue){var G=or(ue,2),Ke=G[0],it=G[1];return ye=(0,le.addQueryParamToUrl)({url:ye,name:Ke,value:it}).newUrl}),ye=i(ye),Object.defineProperty(window,"URL",{value:lr}),ye}return Fe[Je]}})},Object.defineProperty(window,"URL",{value:V}),[4,l.signinRedirect({redirect_uri:q,redirectMethod:L?"replace":"assign"})]);case 1:return B.sent(),[2,new Promise(function(){})]}})})},[4,function(){return we(this,void 0,void 0,function(){var L,B,ue,H,q,ee,V,B,B,G,Ve,G,Te,se,Fe,Je,ye,ue,G,Ke,it,Or,qn=this;return be(this,function(F){switch(F.label){case 0:L=window.location.href;{if(B=(0,le.retrieveQueryParamFromUrl)({name:T,url:L}),!B.wasPresent||B.value!==R)return[3,5];L=B.newUrl}ue="https://dummy.com",H=[];try{for(q=zr(Fr),ee=q.next();!ee.done;ee=q.next()){if(V=ee.value,B=(0,le.retrieveQueryParamFromUrl)({name:V,url:L}),!B.wasPresent){if(V==="iss")continue;H.push(V);continue}ue=(0,le.addQueryParamToUrl)({url:ue,name:V,value:B.value}).newUrl,L=B.newUrl}}catch(te){it={error:te}}finally{try{ee&&!ee.done&&(Or=q.return)&&Or.call(q)}finally{if(it)throw it.error}}if(window.history.pushState(null,"",L),B=(0,le.retrieveQueryParamFromUrl)({name:"error",url:L}),B.wasPresent){if(window!==top&&B.value==="login_required")return[2,new Promise(function(){})];throw new Error(["The OIDC server responded with an error passed as query parameter after the login process","this error is: ".concat(B.value)].join(" "))}if(H.length!==0)throw new Error(["After the login process the following mandatory OIDC query parameters where missing:",H.join(", ")].join(" "));G=void 0,F.label=1;case 1:return F.trys.push([1,3,,4]),[4,l.signinRedirectCallback(ue)];case 2:return G=F.sent(),[3,4];case 3:if(Ve=F.sent(),(0,X.assert)(Ve instanceof Error),Ve.message==="Failed to fetch")throw new ke({type:"bad configuration",likelyCause:{type:"not in Web Origins",clientId:r}});return[2,void 0];case 4:return[2,{loginScenario:"backFromLoginPages",oidcClientTsUser:G}];case 5:return[4,l.getUser()];case 6:if(G=F.sent(),G===null)return[3,11];F.label=7;case 7:return F.trys.push([7,9,,10]),[4,l.signinSilent()];case 8:return F.sent(),[3,10];case 9:if(Te=F.sent(),(0,X.assert)(Te instanceof Error),Te.message==="Failed to fetch")throw new ke({type:"server down",issuerUri:e});return[2,void 0];case 10:return[2,{loginScenario:"sessionStorageRestoration",oidcClientTsUser:G}];case 11:return se=new Ri.Deferred,Fe=function(){var te=(0,Pi.getDownlinkAndRtt)();if(te===void 0)return 5e3;var Me=te.downlink,Ne=te.rtt,Le=3e3,Y=Ne*2.5+3e3/(Me+1);return Math.max(Le,Y)}(),Je=(0,ot.setTimeout)(function(){return we(qn,void 0,void 0,function(){var te,Me=this;return be(this,function(Ne){switch(Ne.label){case 0:return[4,fetch(b).then(function(Le){return we(Me,void 0,void 0,function(){var Y;return be(this,function(Qe){switch(Qe.label){case 0:return[4,Le.text()];case 1:return Y=Qe.sent(),[2,Y.split(`
`).length<20&&Y.includes("parent.postMessage(location.href")]}})})},function(){return!1})];case 1:return te=Ne.sent(),te?(se.reject(new ke({type:"bad configuration",likelyCause:{type:"misconfigured OIDC client",clientId:r,timeoutDelayMs:Fe}})),[2]):(se.reject(new ke({type:"bad configuration",likelyCause:{type:"silent-sso.html not reachable",silentSsoHtmlUrl:b}})),[2])}})})},Fe),ye=function(te){var Me,Ne;if(typeof te.data=="string"){var Le=te.data;{var Y=void 0;try{Y=(0,le.retrieveQueryParamFromUrl)({name:T,url:Le})}catch{return}if(!Y.wasPresent||Y.value!==R)return}(0,ot.clearTimeout)(Je),window.removeEventListener("message",ye);{var Y=(0,le.retrieveQueryParamFromUrl)({name:"error",url:Le});if(Y.wasPresent){se.resolve(void 0);return}}var Qe="https://dummy.com",ar=[];try{for(var Et=zr(Fr),at=Et.next();!at.done;at=Et.next()){var Ct=at.value,Y=(0,le.retrieveQueryParamFromUrl)({name:Ct,url:Le});if(!Y.wasPresent){if(Ct==="iss")continue;ar.push(Ct);continue}Qe=(0,le.addQueryParamToUrl)({url:Qe,name:Ct,value:Y.value}).newUrl}}catch(Rr){Me={error:Rr}}finally{try{at&&!at.done&&(Ne=Et.return)&&Ne.call(Et)}finally{if(Me)throw Me.error}}if(ar.length!==0){se.reject(new Error(["After the silent signin process the following mandatory OIDC query parameters where missing:",ar.join(", ")].join(" ")));return}se.resolve(Qe)}},window.addEventListener("message",ye,!1),l.signinSilent({silentRequestTimeoutInSeconds:Fe/1e3}).catch(function(te){te.message==="Failed to fetch"&&((0,ot.clearTimeout)(Je),se.reject(new ke({type:"server down",issuerUri:e})))}),[4,se.pr];case 12:if(ue=F.sent(),ue===void 0)return[3,17];G=void 0,F.label=13;case 13:return F.trys.push([13,15,,16]),[4,l.signinRedirectCallback(ue)];case 14:return G=F.sent(),[3,16];case 15:throw Ke=F.sent(),(0,X.assert)(Ke instanceof Error),Ke.message==="Failed to fetch"?new ke({type:"bad configuration",likelyCause:{type:"not in Web Origins",clientId:r}}):Ke;case 16:return[2,{loginScenario:"silentSignin",oidcClientTsUser:G}];case 17:return[2,void 0]}})})}().then(function(U){if(U!==void 0){var L=U.oidcClientTsUser,H=U.loginScenario,q=Jr({oidcClientTsUser:L,decodedIdTokenSchema:u});return q.refreshTokenExpirationTime<q.accessTokenExpirationTime&&console.warn(["The OIDC refresh token shorter than the one of the access token.","This is very unusual and probably a misconfiguration.","Check your oidc server configuration for ".concat(r," ").concat(e)].join(" ")),{tokens:q,loginScenario:H}}},function(U){return(0,X.assert)(U instanceof Error),U})];case 1:return A=Cr.sent(),N={params:{issuerUri:e,clientId:r}},A instanceof Error?(Z=A,K=Z instanceof ke?Z:new ke({type:"unknown",cause:Z}),console.error('OIDC initialization error of type "'.concat(K.type,'": ').concat(K.message)),w(),[2,(0,cr.id)(ge(ge({},N),{isUserLoggedIn:!1,login:function(){return we(It,void 0,void 0,function(){return be(this,function(U){return alert("Authentication is currently unavailable. Please try again later."),[2,new Promise(function(){})]})})},initializationError:K}))]):A===void 0?(w(),[2,(0,cr.id)(ge(ge({},N),{isUserLoggedIn:!1,login:j,initializationError:void 0}))]):(D=A.tokens,re=new Set,de=new Set,ve=(0,cr.id)(ge(ge({},N),{isUserLoggedIn:!0,getTokens:function(){return D},logout:function(U){return we(It,void 0,void 0,function(){return be(this,function(L){switch(L.label){case 0:return[4,l.signoutRedirect({post_logout_redirect_uri:function(){switch(U.redirectTo){case"current page":return window.location.href;case"home":return m;case"specific url":return U.url.startsWith("/")?"".concat(window.location.origin).concat(U.url):U.url}(0,X.assert)(!1)}()})];case 1:return L.sent(),[2,new Promise(function(){})]}})})},renewTokens:function(){return we(It,void 0,void 0,function(){var U,L;return be(this,function(H){switch(H.label){case 0:return[4,l.signinSilent()];case 1:return U=H.sent(),(0,X.assert)(U!==null),L=Object.getOwnPropertyDescriptor(D,"decodedIdToken"),(0,X.assert)(L!==void 0),D=Jr({oidcClientTsUser:U,decodedIdTokenSchema:u}),Object.defineProperty(D,"decodedIdToken",L),Array.from(de).forEach(function(q){return q()}),[2]}})})},subscribeToTokensChange:function(U){return de.add(U),{unsubscribe:function(){de.delete(U)}}},subscribeToAutoLogoutCountdown:function(U){re.add(U);var L=function(){re.delete(U)};return{unsubscribeFromAutoLogoutCountdown:L}},loginScenario:A.loginScenario})),je=function(){var U=Math.min(D.accessTokenExpirationTime,D.refreshTokenExpirationTime);return Math.min(U-Date.now(),Math.pow(2,31)-1)},function U(){var L=this,H=Math.min(25e3,je()*.1),q=(0,ot.setTimeout)(function(){return we(L,void 0,void 0,function(){return be(this,function(V){switch(V.label){case 0:ee(),V.label=1;case 1:return V.trys.push([1,3,,5]),[4,ve.renewTokens()];case 2:return V.sent(),[3,5];case 3:return V.sent(),[4,j({doesCurrentHrefRequiresAuth:!1})];case 4:return V.sent(),[3,5];case 5:return U(),[2]}})})},je()-H),ee=ve.subscribeToTokensChange(function(){(0,ot.clearTimeout)(q),ee(),U()}).unsubscribe}(),We=(0,ji.createStartCountdown)({getCountdownEndTime:function(){return o??D.refreshTokenExpirationTime},tickCallback:function(U){var L=U.secondsLeft;Array.from(re).forEach(function(H){return H({secondsLeft:L})}),L===0&&ve.logout(h)}}).startCountdown,Q=void 0,dr===void 0&&(dr=(0,Ai.createIsUserActive)({theUserIsConsideredInactiveAfterMsOfInactivity:5e3}).$isUserActive),ze=dr.subscribe(function(U){U?Q!==void 0&&(Q(),Q=void 0):((0,X.assert)(Q===void 0),Q=We().stopCountdown)}).unsubscribe,ir=ur.get(R),(0,X.assert)(ir!==void 0),ir.add(function(){ze(),Q==null||Q()}),[2,ve])}})})}rt.createOidc=Mi;function Jr(t){var e=t.oidcClientTsUser,r=t.decodedIdTokenSchema,n=e.access_token,s=function(){e:{var d=e.expires_at;if(d===void 0)break e;return d*1e3}e:{var h=(0,Vr.readExpirationTimeInJwt)(n);if(h===void 0)break e;return h}(0,X.assert)(!1,"Failed to get access token expiration time")}(),i=e.refresh_token;(0,X.assert)(i!==void 0,"No refresh token provided by the oidc server");var a=function(){e:{var d=(0,Vr.readExpirationTimeInJwt)(i);if(d===void 0)break e;return d}(0,X.assert)(!1,"Failed to get refresh token expiration time")}(),c=e.id_token;(0,X.assert)(c!==void 0,"No id token provided by the oidc server");var u={accessToken:n,accessTokenExpirationTime:s,refreshToken:i,refreshTokenExpirationTime:a,idToken:c,decodedIdToken:null},o=void 0;return Object.defineProperty(u,"decodedIdToken",{get:function(){if(o!==void 0&&o.idToken===this.idToken)return o.decodedIdToken;var d=(0,Ui.decodeJwt)(this.idToken);return r!==void 0&&(d=r.parse(d)),o={idToken:this.idToken,decodedIdToken:d},d},configurable:!0,enumerable:!0}),u}var nr={},Ni=I&&I.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],a;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(c){a={error:c}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Li=I&&I.__spreadArray||function(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))};Object.defineProperty(nr,"__esModule",{value:!0});nr.useGuaranteedMemo=void 0;var Zi=rn;function $i(t,e){var r=(0,Zi.useRef)();return(!r.current||e.length!==r.current.prevDeps.length||r.current.prevDeps.map(function(n,s){return n===e[s]}).indexOf(!1)>=0)&&(r.current={v:t(),prevDeps:Li([],Ni(e),!1)}),r.current.v}nr.useGuaranteedMemo=$i;var Xe=I&&I.__assign||function(){return Xe=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Xe.apply(this,arguments)},Kr=I&&I.__read||function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],a;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(c){a={error:c}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i};Object.defineProperty(tt,"__esModule",{value:!0});tt.createReactOidc=tt.createReactOidc_dependencyInjection=void 0;var hr=W,Ge=rn,Di=rt,Qr=St(),Gr=tn,qi=nr,Yr=(0,Ge.createContext)(void 0);function Cn(t,e){var r=Promise.resolve(e(t)),n=("decodedIdTokenSchema"in t?t:{decodedIdTokenSchema:void 0}).decodedIdTokenSchema;function s(a){var c=a.children,u=a.fallback,o=Kr((0,Ge.useState)(void 0),2),d=o[0],h=o[1];return(0,Ge.useEffect)(function(){r.then(h)},[]),d===void 0?(0,hr.jsx)(hr.Fragment,{children:u===void 0?null:u}):(0,hr.jsx)(Yr.Provider,{value:{oidc:d,decodedIdTokenSchema:n},children:c})}function i(a){var c=(a??{}).assertUserLoggedIn,u=c===void 0?!1:c,o=function(){var b=(0,Ge.useContext)(Yr);return(0,Qr.assert)(b!==void 0,"You must use useOidc inside a OidcProvider"),b}(),d=o.oidc,h=o.decodedIdTokenSchema,v=Kr((0,Ge.useReducer)(function(){return[]},[]),2),m=v[1];if((0,Ge.useEffect)(function(){if(d.isUserLoggedIn){var T=d.subscribeToTokensChange(m).unsubscribe;return T}},[d]),u&&!d.isUserLoggedIn)throw new Error("The user must be logged in to use this hook (assertUserLoggedIn was set to true)");var R=function(){var b=d.isUserLoggedIn?d.getTokens():void 0,l=(0,qi.useGuaranteedMemo)(function(){if(b!==void 0){var g={accessToken:b.accessToken,accessTokenExpirationTime:b.accessTokenExpirationTime,idToken:b.idToken,refreshToken:b.refreshToken,refreshTokenExpirationTime:b.refreshTokenExpirationTime,decodedIdToken:null},w=void 0;return Object.defineProperty(g,"decodedIdToken",{get:function(){if(w!==void 0)return w.decodedIdToken;var S=b.decodedIdToken;return n!==void 0&&n!==h&&(S=n.parse(S)),w={decodedIdToken:S},S}}),g}},[b==null?void 0:b.accessToken,b==null?void 0:b.accessTokenExpirationTime,b==null?void 0:b.idToken,b==null?void 0:b.refreshToken,b==null?void 0:b.refreshTokenExpirationTime]);return{oidcTokens:l}}().oidcTokens,y={params:d.params};return d.isUserLoggedIn?(0,Gr.id)(((0,Qr.assert)(R!==void 0),Xe(Xe({},y),{isUserLoggedIn:!0,oidcTokens:R,logout:d.logout,renewTokens:d.renewTokens,subscribeToAutoLogoutCountdown:d.subscribeToAutoLogoutCountdown}))):(0,Gr.id)(Xe(Xe({},y),{isUserLoggedIn:!1,login:d.login,initializationError:d.initializationError}))}return{OidcProvider:s,useOidc:i,prOidc:r}}tt.createReactOidc_dependencyInjection=Cn;function Hi(t){return Cn(t,Di.createOidc)}tt.createReactOidc=Hi;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.createReactOidc=void 0;var e=tt;Object.defineProperty(t,"createReactOidc",{enumerable:!0,get:function(){return e.createReactOidc}})})(nn);var M;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function r(s){throw new Error}t.assertNever=r,t.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(c=>typeof s[s[c]]!="number"),a={};for(const c of i)a[c]=s[c];return t.objectValues(a)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},t.find=(s,i)=>{for(const a of s)if(i(a))return a},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(M||(M={}));var yr;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(yr||(yr={}));const p=M.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ce=t=>{switch(typeof t){case"undefined":return p.undefined;case"string":return p.string;case"number":return isNaN(t)?p.nan:p.number;case"boolean":return p.boolean;case"function":return p.function;case"bigint":return p.bigint;case"symbol":return p.symbol;case"object":return Array.isArray(t)?p.array:t===null?p.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?p.promise:typeof Map<"u"&&t instanceof Map?p.map:typeof Set<"u"&&t instanceof Set?p.set:typeof Date<"u"&&t instanceof Date?p.date:p.object;default:return p.unknown}},f=M.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Bi=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class ae extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const r=e||function(i){return i.message},n={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)n._errors.push(r(a));else{let c=n,u=0;for(;u<a.path.length;){const o=a.path[u];u===a.path.length-1?(c[o]=c[o]||{_errors:[]},c[o]._errors.push(r(a))):c[o]=c[o]||{_errors:[]},c=c[o],u++}}};return s(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,M.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}ae.create=t=>new ae(t);const lt=(t,e)=>{let r;switch(t.code){case f.invalid_type:t.received===p.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case f.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,M.jsonStringifyReplacer)}`;break;case f.unrecognized_keys:r=`Unrecognized key(s) in object: ${M.joinValues(t.keys,", ")}`;break;case f.invalid_union:r="Invalid input";break;case f.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${M.joinValues(t.options)}`;break;case f.invalid_enum_value:r=`Invalid enum value. Expected ${M.joinValues(t.options)}, received '${t.received}'`;break;case f.invalid_arguments:r="Invalid function arguments";break;case f.invalid_return_type:r="Invalid function return type";break;case f.invalid_date:r="Invalid date";break;case f.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:M.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case f.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case f.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case f.custom:r="Invalid input";break;case f.invalid_intersection_types:r="Intersection results could not be merged";break;case f.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case f.not_finite:r="Number must be finite";break;default:r=e.defaultError,M.assertNever(t)}return{message:r}};let On=lt;function Wi(t){On=t}function At(){return On}const jt=t=>{const{data:e,path:r,errorMaps:n,issueData:s}=t,i=[...r,...s.path||[]],a={...s,path:i};let c="";const u=n.filter(o=>!!o).slice().reverse();for(const o of u)c=o(a,{data:e,defaultError:c}).message;return{...s,path:i,message:s.message||c}},zi=[];function _(t,e){const r=jt({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,At(),lt].filter(n=>!!n)});t.common.issues.push(r)}class z{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const s of r){if(s.status==="aborted")return C;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const s of r)n.push({key:await s.key,value:await s.value});return z.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const s of r){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return C;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(n[i.value]=a.value)}return{status:e.value,value:n}}}const C=Object.freeze({status:"aborted"}),Rn=t=>({status:"dirty",value:t}),J=t=>({status:"valid",value:t}),wr=t=>t.status==="aborted",br=t=>t.status==="dirty",ht=t=>t.status==="valid",Mt=t=>typeof Promise<"u"&&t instanceof Promise;var k;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(k||(k={}));class _e{constructor(e,r,n,s){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Xr=(t,e)=>{if(ht(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new ae(t.common.issues);return this._error=r,this._error}}};function O(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:s}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(a,c)=>a.code!=="invalid_type"?{message:c.defaultError}:typeof c.data>"u"?{message:n??c.defaultError}:{message:r??c.defaultError},description:s}}class P{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Ce(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Ce(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new z,ctx:{common:e.parent.common,data:e.data,parsedType:Ce(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(Mt(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){var n;const s={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ce(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Xr(s,i)}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ce(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(Mt(s)?s:Promise.resolve(s));return Xr(n,i)}refine(e,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,i)=>{const a=e(s),c=()=>i.addIssue({code:f.custom,...n(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(u=>u?!0:(c(),!1)):a?!0:(c(),!1)})}refinement(e,r){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(e){return new ce({schema:this,typeName:x.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Se.create(this,this._def)}nullable(){return Be.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return oe.create(this,this._def)}promise(){return st.create(this,this._def)}or(e){return _t.create([this,e],this._def)}and(e){return mt.create(this,e,this._def)}transform(e){return new ce({...O(this._def),schema:this,typeName:x.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new kt({...O(this._def),innerType:this,defaultValue:r,typeName:x.ZodDefault})}brand(){return new Pn({typeName:x.ZodBranded,type:this,...O(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new $t({...O(this._def),innerType:this,catchValue:r,typeName:x.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Tt.create(this,e)}readonly(){return qt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Vi=/^c[^\s-]{8,}$/i,Fi=/^[a-z][a-z0-9]*$/,Ji=/^[0-9A-HJKMNP-TV-Z]{26}$/,Ki=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Qi=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Gi="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let fr;const Yi=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,Xi=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ea=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function ta(t,e){return!!((e==="v4"||!e)&&Yi.test(t)||(e==="v6"||!e)&&Xi.test(t))}class ie extends P{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==p.string){const i=this._getOrReturnCtx(e);return _(i,{code:f.invalid_type,expected:p.string,received:i.parsedType}),C}const n=new z;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),_(s,{code:f.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),_(s,{code:f.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const a=e.data.length>i.value,c=e.data.length<i.value;(a||c)&&(s=this._getOrReturnCtx(e,s),a?_(s,{code:f.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&_(s,{code:f.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")Qi.test(e.data)||(s=this._getOrReturnCtx(e,s),_(s,{validation:"email",code:f.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")fr||(fr=new RegExp(Gi,"u")),fr.test(e.data)||(s=this._getOrReturnCtx(e,s),_(s,{validation:"emoji",code:f.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")Ki.test(e.data)||(s=this._getOrReturnCtx(e,s),_(s,{validation:"uuid",code:f.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")Vi.test(e.data)||(s=this._getOrReturnCtx(e,s),_(s,{validation:"cuid",code:f.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")Fi.test(e.data)||(s=this._getOrReturnCtx(e,s),_(s,{validation:"cuid2",code:f.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")Ji.test(e.data)||(s=this._getOrReturnCtx(e,s),_(s,{validation:"ulid",code:f.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),_(s,{validation:"url",code:f.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),_(s,{validation:"regex",code:f.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),_(s,{code:f.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),_(s,{code:f.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),_(s,{code:f.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?ea(i).test(e.data)||(s=this._getOrReturnCtx(e,s),_(s,{code:f.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="ip"?ta(e.data,i.version)||(s=this._getOrReturnCtx(e,s),_(s,{validation:"ip",code:f.invalid_string,message:i.message}),n.dirty()):M.assertNever(i);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(s=>e.test(s),{validation:r,code:f.invalid_string,...k.errToObj(n)})}_addCheck(e){return new ie({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}datetime(e){var r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(r=e==null?void 0:e.offset)!==null&&r!==void 0?r:!1,...k.errToObj(e==null?void 0:e.message)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...k.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r==null?void 0:r.position,...k.errToObj(r==null?void 0:r.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...k.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...k.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...k.errToObj(r)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new ie({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ie({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ie({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}ie.create=t=>{var e;return new ie({checks:[],typeName:x.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...O(t)})};function ra(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,i=parseInt(t.toFixed(s).replace(".","")),a=parseInt(e.toFixed(s).replace(".",""));return i%a/Math.pow(10,s)}class Ue extends P{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==p.number){const i=this._getOrReturnCtx(e);return _(i,{code:f.invalid_type,expected:p.number,received:i.parsedType}),C}let n;const s=new z;for(const i of this._def.checks)i.kind==="int"?M.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),_(n,{code:f.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),_(n,{code:f.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),_(n,{code:f.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?ra(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),_(n,{code:f.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),_(n,{code:f.not_finite,message:i.message}),s.dirty()):M.assertNever(i);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,k.toString(r))}gt(e,r){return this.setLimit("min",e,!1,k.toString(r))}lte(e,r){return this.setLimit("max",e,!0,k.toString(r))}lt(e,r){return this.setLimit("max",e,!1,k.toString(r))}setLimit(e,r,n,s){return new Ue({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:k.toString(s)}]})}_addCheck(e){return new Ue({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&M.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}Ue.create=t=>new Ue({checks:[],typeName:x.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...O(t)});class Pe extends P{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==p.bigint){const i=this._getOrReturnCtx(e);return _(i,{code:f.invalid_type,expected:p.bigint,received:i.parsedType}),C}let n;const s=new z;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),_(n,{code:f.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),_(n,{code:f.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),_(n,{code:f.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):M.assertNever(i);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,k.toString(r))}gt(e,r){return this.setLimit("min",e,!1,k.toString(r))}lte(e,r){return this.setLimit("max",e,!0,k.toString(r))}lt(e,r){return this.setLimit("max",e,!1,k.toString(r))}setLimit(e,r,n,s){return new Pe({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:k.toString(s)}]})}_addCheck(e){return new Pe({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Pe.create=t=>{var e;return new Pe({checks:[],typeName:x.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...O(t)})};class ft extends P{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==p.boolean){const n=this._getOrReturnCtx(e);return _(n,{code:f.invalid_type,expected:p.boolean,received:n.parsedType}),C}return J(e.data)}}ft.create=t=>new ft({typeName:x.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...O(t)});class qe extends P{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==p.date){const i=this._getOrReturnCtx(e);return _(i,{code:f.invalid_type,expected:p.date,received:i.parsedType}),C}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return _(i,{code:f.invalid_date}),C}const n=new z;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),_(s,{code:f.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),_(s,{code:f.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):M.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new qe({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}qe.create=t=>new qe({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:x.ZodDate,...O(t)});class Nt extends P{_parse(e){if(this._getType(e)!==p.symbol){const n=this._getOrReturnCtx(e);return _(n,{code:f.invalid_type,expected:p.symbol,received:n.parsedType}),C}return J(e.data)}}Nt.create=t=>new Nt({typeName:x.ZodSymbol,...O(t)});class gt extends P{_parse(e){if(this._getType(e)!==p.undefined){const n=this._getOrReturnCtx(e);return _(n,{code:f.invalid_type,expected:p.undefined,received:n.parsedType}),C}return J(e.data)}}gt.create=t=>new gt({typeName:x.ZodUndefined,...O(t)});class pt extends P{_parse(e){if(this._getType(e)!==p.null){const n=this._getOrReturnCtx(e);return _(n,{code:f.invalid_type,expected:p.null,received:n.parsedType}),C}return J(e.data)}}pt.create=t=>new pt({typeName:x.ZodNull,...O(t)});class nt extends P{constructor(){super(...arguments),this._any=!0}_parse(e){return J(e.data)}}nt.create=t=>new nt({typeName:x.ZodAny,...O(t)});class Ze extends P{constructor(){super(...arguments),this._unknown=!0}_parse(e){return J(e.data)}}Ze.create=t=>new Ze({typeName:x.ZodUnknown,...O(t)});class xe extends P{_parse(e){const r=this._getOrReturnCtx(e);return _(r,{code:f.invalid_type,expected:p.never,received:r.parsedType}),C}}xe.create=t=>new xe({typeName:x.ZodNever,...O(t)});class Lt extends P{_parse(e){if(this._getType(e)!==p.undefined){const n=this._getOrReturnCtx(e);return _(n,{code:f.invalid_type,expected:p.void,received:n.parsedType}),C}return J(e.data)}}Lt.create=t=>new Lt({typeName:x.ZodVoid,...O(t)});class oe extends P{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),s=this._def;if(r.parsedType!==p.array)return _(r,{code:f.invalid_type,expected:p.array,received:r.parsedType}),C;if(s.exactLength!==null){const a=r.data.length>s.exactLength.value,c=r.data.length<s.exactLength.value;(a||c)&&(_(r,{code:a?f.too_big:f.too_small,minimum:c?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(_(r,{code:f.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(_(r,{code:f.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((a,c)=>s.type._parseAsync(new _e(r,a,r.path,c)))).then(a=>z.mergeArray(n,a));const i=[...r.data].map((a,c)=>s.type._parseSync(new _e(r,a,r.path,c)));return z.mergeArray(n,i)}get element(){return this._def.type}min(e,r){return new oe({...this._def,minLength:{value:e,message:k.toString(r)}})}max(e,r){return new oe({...this._def,maxLength:{value:e,message:k.toString(r)}})}length(e,r){return new oe({...this._def,exactLength:{value:e,message:k.toString(r)}})}nonempty(e){return this.min(1,e)}}oe.create=(t,e)=>new oe({type:t,minLength:null,maxLength:null,exactLength:null,typeName:x.ZodArray,...O(e)});function Ye(t){if(t instanceof $){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=Se.create(Ye(n))}return new $({...t._def,shape:()=>e})}else return t instanceof oe?new oe({...t._def,type:Ye(t.element)}):t instanceof Se?Se.create(Ye(t.unwrap())):t instanceof Be?Be.create(Ye(t.unwrap())):t instanceof me?me.create(t.items.map(e=>Ye(e))):t}class $ extends P{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=M.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==p.object){const o=this._getOrReturnCtx(e);return _(o,{code:f.invalid_type,expected:p.object,received:o.parsedType}),C}const{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),c=[];if(!(this._def.catchall instanceof xe&&this._def.unknownKeys==="strip"))for(const o in s.data)a.includes(o)||c.push(o);const u=[];for(const o of a){const d=i[o],h=s.data[o];u.push({key:{status:"valid",value:o},value:d._parse(new _e(s,h,s.path,o)),alwaysSet:o in s.data})}if(this._def.catchall instanceof xe){const o=this._def.unknownKeys;if(o==="passthrough")for(const d of c)u.push({key:{status:"valid",value:d},value:{status:"valid",value:s.data[d]}});else if(o==="strict")c.length>0&&(_(s,{code:f.unrecognized_keys,keys:c}),n.dirty());else if(o!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const o=this._def.catchall;for(const d of c){const h=s.data[d];u.push({key:{status:"valid",value:d},value:o._parse(new _e(s,h,s.path,d)),alwaysSet:d in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const o=[];for(const d of u){const h=await d.key;o.push({key:h,value:await d.value,alwaysSet:d.alwaysSet})}return o}).then(o=>z.mergeObjectSync(n,o)):z.mergeObjectSync(n,u)}get shape(){return this._def.shape()}strict(e){return k.errToObj,new $({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{var s,i,a,c;const u=(a=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,r,n).message)!==null&&a!==void 0?a:n.defaultError;return r.code==="unrecognized_keys"?{message:(c=k.errToObj(e).message)!==null&&c!==void 0?c:u}:{message:u}}}:{}})}strip(){return new $({...this._def,unknownKeys:"strip"})}passthrough(){return new $({...this._def,unknownKeys:"passthrough"})}extend(e){return new $({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new $({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:x.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new $({...this._def,catchall:e})}pick(e){const r={};return M.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new $({...this._def,shape:()=>r})}omit(e){const r={};return M.objectKeys(this.shape).forEach(n=>{e[n]||(r[n]=this.shape[n])}),new $({...this._def,shape:()=>r})}deepPartial(){return Ye(this)}partial(e){const r={};return M.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];e&&!e[n]?r[n]=s:r[n]=s.optional()}),new $({...this._def,shape:()=>r})}required(e){const r={};return M.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Se;)i=i._def.innerType;r[n]=i}}),new $({...this._def,shape:()=>r})}keyof(){return Un(M.objectKeys(this.shape))}}$.create=(t,e)=>new $({shape:()=>t,unknownKeys:"strip",catchall:xe.create(),typeName:x.ZodObject,...O(e)});$.strictCreate=(t,e)=>new $({shape:()=>t,unknownKeys:"strict",catchall:xe.create(),typeName:x.ZodObject,...O(e)});$.lazycreate=(t,e)=>new $({shape:t,unknownKeys:"strip",catchall:xe.create(),typeName:x.ZodObject,...O(e)});class _t extends P{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function s(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return r.common.issues.push(...c.ctx.common.issues),c.result;const a=i.map(c=>new ae(c.ctx.common.issues));return _(r,{code:f.invalid_union,unionErrors:a}),C}if(r.common.async)return Promise.all(n.map(async i=>{const a={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const u of n){const o={...r,common:{...r.common,issues:[]},parent:null},d=u._parseSync({data:r.data,path:r.path,parent:o});if(d.status==="valid")return d;d.status==="dirty"&&!i&&(i={result:d,ctx:o}),o.common.issues.length&&a.push(o.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const c=a.map(u=>new ae(u));return _(r,{code:f.invalid_union,unionErrors:c}),C}}get options(){return this._def.options}}_t.create=(t,e)=>new _t({options:t,typeName:x.ZodUnion,...O(e)});const Ut=t=>t instanceof yt?Ut(t.schema):t instanceof ce?Ut(t.innerType()):t instanceof wt?[t.value]:t instanceof Ae?t.options:t instanceof bt?Object.keys(t.enum):t instanceof kt?Ut(t._def.innerType):t instanceof gt?[void 0]:t instanceof pt?[null]:null;class sr extends P{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==p.object)return _(r,{code:f.invalid_type,expected:p.object,received:r.parsedType}),C;const n=this.discriminator,s=r.data[n],i=this.optionsMap.get(s);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(_(r,{code:f.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),C)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){const s=new Map;for(const i of r){const a=Ut(i.shape[e]);if(!a)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const c of a){if(s.has(c))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(c)}`);s.set(c,i)}}return new sr({typeName:x.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:s,...O(n)})}}function kr(t,e){const r=Ce(t),n=Ce(e);if(t===e)return{valid:!0,data:t};if(r===p.object&&n===p.object){const s=M.objectKeys(e),i=M.objectKeys(t).filter(c=>s.indexOf(c)!==-1),a={...t,...e};for(const c of i){const u=kr(t[c],e[c]);if(!u.valid)return{valid:!1};a[c]=u.data}return{valid:!0,data:a}}else if(r===p.array&&n===p.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const a=t[i],c=e[i],u=kr(a,c);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return r===p.date&&n===p.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class mt extends P{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=(i,a)=>{if(wr(i)||wr(a))return C;const c=kr(i.value,a.value);return c.valid?((br(i)||br(a))&&r.dirty(),{status:r.value,value:c.data}):(_(n,{code:f.invalid_intersection_types}),C)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}mt.create=(t,e,r)=>new mt({left:t,right:e,typeName:x.ZodIntersection,...O(r)});class me extends P{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==p.array)return _(n,{code:f.invalid_type,expected:p.array,received:n.parsedType}),C;if(n.data.length<this._def.items.length)return _(n,{code:f.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),C;!this._def.rest&&n.data.length>this._def.items.length&&(_(n,{code:f.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((a,c)=>{const u=this._def.items[c]||this._def.rest;return u?u._parse(new _e(n,a,n.path,c)):null}).filter(a=>!!a);return n.common.async?Promise.all(i).then(a=>z.mergeArray(r,a)):z.mergeArray(r,i)}get items(){return this._def.items}rest(e){return new me({...this._def,rest:e})}}me.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new me({items:t,typeName:x.ZodTuple,rest:null,...O(e)})};class vt extends P{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==p.object)return _(n,{code:f.invalid_type,expected:p.object,received:n.parsedType}),C;const s=[],i=this._def.keyType,a=this._def.valueType;for(const c in n.data)s.push({key:i._parse(new _e(n,c,n.path,c)),value:a._parse(new _e(n,n.data[c],n.path,c))});return n.common.async?z.mergeObjectAsync(r,s):z.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof P?new vt({keyType:e,valueType:r,typeName:x.ZodRecord,...O(n)}):new vt({keyType:ie.create(),valueType:e,typeName:x.ZodRecord,...O(r)})}}class Zt extends P{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==p.map)return _(n,{code:f.invalid_type,expected:p.map,received:n.parsedType}),C;const s=this._def.keyType,i=this._def.valueType,a=[...n.data.entries()].map(([c,u],o)=>({key:s._parse(new _e(n,c,n.path,[o,"key"])),value:i._parse(new _e(n,u,n.path,[o,"value"]))}));if(n.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const u of a){const o=await u.key,d=await u.value;if(o.status==="aborted"||d.status==="aborted")return C;(o.status==="dirty"||d.status==="dirty")&&r.dirty(),c.set(o.value,d.value)}return{status:r.value,value:c}})}else{const c=new Map;for(const u of a){const o=u.key,d=u.value;if(o.status==="aborted"||d.status==="aborted")return C;(o.status==="dirty"||d.status==="dirty")&&r.dirty(),c.set(o.value,d.value)}return{status:r.value,value:c}}}}Zt.create=(t,e,r)=>new Zt({valueType:e,keyType:t,typeName:x.ZodMap,...O(r)});class He extends P{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==p.set)return _(n,{code:f.invalid_type,expected:p.set,received:n.parsedType}),C;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(_(n,{code:f.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(_(n,{code:f.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const i=this._def.valueType;function a(u){const o=new Set;for(const d of u){if(d.status==="aborted")return C;d.status==="dirty"&&r.dirty(),o.add(d.value)}return{status:r.value,value:o}}const c=[...n.data.values()].map((u,o)=>i._parse(new _e(n,u,n.path,o)));return n.common.async?Promise.all(c).then(u=>a(u)):a(c)}min(e,r){return new He({...this._def,minSize:{value:e,message:k.toString(r)}})}max(e,r){return new He({...this._def,maxSize:{value:e,message:k.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}He.create=(t,e)=>new He({valueType:t,minSize:null,maxSize:null,typeName:x.ZodSet,...O(e)});class et extends P{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==p.function)return _(r,{code:f.invalid_type,expected:p.function,received:r.parsedType}),C;function n(c,u){return jt({data:c,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,At(),lt].filter(o=>!!o),issueData:{code:f.invalid_arguments,argumentsError:u}})}function s(c,u){return jt({data:c,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,At(),lt].filter(o=>!!o),issueData:{code:f.invalid_return_type,returnTypeError:u}})}const i={errorMap:r.common.contextualErrorMap},a=r.data;if(this._def.returns instanceof st){const c=this;return J(async function(...u){const o=new ae([]),d=await c._def.args.parseAsync(u,i).catch(m=>{throw o.addIssue(n(u,m)),o}),h=await Reflect.apply(a,this,d);return await c._def.returns._def.type.parseAsync(h,i).catch(m=>{throw o.addIssue(s(h,m)),o})})}else{const c=this;return J(function(...u){const o=c._def.args.safeParse(u,i);if(!o.success)throw new ae([n(u,o.error)]);const d=Reflect.apply(a,this,o.data),h=c._def.returns.safeParse(d,i);if(!h.success)throw new ae([s(d,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new et({...this._def,args:me.create(e).rest(Ze.create())})}returns(e){return new et({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new et({args:e||me.create([]).rest(Ze.create()),returns:r||Ze.create(),typeName:x.ZodFunction,...O(n)})}}class yt extends P{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}yt.create=(t,e)=>new yt({getter:t,typeName:x.ZodLazy,...O(e)});class wt extends P{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return _(r,{received:r.data,code:f.invalid_literal,expected:this._def.value}),C}return{status:"valid",value:e.data}}get value(){return this._def.value}}wt.create=(t,e)=>new wt({value:t,typeName:x.ZodLiteral,...O(e)});function Un(t,e){return new Ae({values:t,typeName:x.ZodEnum,...O(e)})}class Ae extends P{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return _(r,{expected:M.joinValues(n),received:r.parsedType,code:f.invalid_type}),C}if(this._def.values.indexOf(e.data)===-1){const r=this._getOrReturnCtx(e),n=this._def.values;return _(r,{received:r.data,code:f.invalid_enum_value,options:n}),C}return J(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e){return Ae.create(e)}exclude(e){return Ae.create(this.options.filter(r=>!e.includes(r)))}}Ae.create=Un;class bt extends P{_parse(e){const r=M.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==p.string&&n.parsedType!==p.number){const s=M.objectValues(r);return _(n,{expected:M.joinValues(s),received:n.parsedType,code:f.invalid_type}),C}if(r.indexOf(e.data)===-1){const s=M.objectValues(r);return _(n,{received:n.data,code:f.invalid_enum_value,options:s}),C}return J(e.data)}get enum(){return this._def.values}}bt.create=(t,e)=>new bt({values:t,typeName:x.ZodNativeEnum,...O(e)});class st extends P{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==p.promise&&r.common.async===!1)return _(r,{code:f.invalid_type,expected:p.promise,received:r.parsedType}),C;const n=r.parsedType===p.promise?r.data:Promise.resolve(r.data);return J(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}st.create=(t,e)=>new st({type:t,typeName:x.ZodPromise,...O(e)});class ce extends P{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===x.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:a=>{_(n,a),a.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(n.data,i);return n.common.issues.length?{status:"dirty",value:n.data}:n.common.async?Promise.resolve(a).then(c=>this._def.schema._parseAsync({data:c,path:n.path,parent:n})):this._def.schema._parseSync({data:a,path:n.path,parent:n})}if(s.type==="refinement"){const a=c=>{const u=s.refinement(c,i);if(n.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(n.common.async===!1){const c=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return c.status==="aborted"?C:(c.status==="dirty"&&r.dirty(),a(c.value),{status:r.value,value:c.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(c=>c.status==="aborted"?C:(c.status==="dirty"&&r.dirty(),a(c.value).then(()=>({status:r.value,value:c.value}))))}if(s.type==="transform")if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ht(a))return a;const c=s.transform(a.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:c}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>ht(a)?Promise.resolve(s.transform(a.value,i)).then(c=>({status:r.value,value:c})):a);M.assertNever(s)}}ce.create=(t,e,r)=>new ce({schema:t,typeName:x.ZodEffects,effect:e,...O(r)});ce.createWithPreprocess=(t,e,r)=>new ce({schema:e,effect:{type:"preprocess",transform:t},typeName:x.ZodEffects,...O(r)});class Se extends P{_parse(e){return this._getType(e)===p.undefined?J(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Se.create=(t,e)=>new Se({innerType:t,typeName:x.ZodOptional,...O(e)});class Be extends P{_parse(e){return this._getType(e)===p.null?J(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Be.create=(t,e)=>new Be({innerType:t,typeName:x.ZodNullable,...O(e)});class kt extends P{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===p.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}kt.create=(t,e)=>new kt({innerType:t,typeName:x.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...O(e)});class $t extends P{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Mt(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ae(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ae(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}$t.create=(t,e)=>new $t({innerType:t,typeName:x.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...O(e)});class Dt extends P{_parse(e){if(this._getType(e)!==p.nan){const n=this._getOrReturnCtx(e);return _(n,{code:f.invalid_type,expected:p.nan,received:n.parsedType}),C}return{status:"valid",value:e.data}}}Dt.create=t=>new Dt({typeName:x.ZodNaN,...O(t)});const na=Symbol("zod_brand");class Pn extends P{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Tt extends P{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?C:i.status==="dirty"?(r.dirty(),Rn(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?C:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,r){return new Tt({in:e,out:r,typeName:x.ZodPipeline})}}class qt extends P{_parse(e){const r=this._def.innerType._parse(e);return ht(r)&&(r.value=Object.freeze(r.value)),r}}qt.create=(t,e)=>new qt({innerType:t,typeName:x.ZodReadonly,...O(e)});const An=(t,e={},r)=>t?nt.create().superRefine((n,s)=>{var i,a;if(!t(n)){const c=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,u=(a=(i=c.fatal)!==null&&i!==void 0?i:r)!==null&&a!==void 0?a:!0,o=typeof c=="string"?{message:c}:c;s.addIssue({code:"custom",...o,fatal:u})}}):nt.create(),sa={object:$.lazycreate};var x;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(x||(x={}));const ia=(t,e={message:`Input not instance of ${t.name}`})=>An(r=>r instanceof t,e),jn=ie.create,Mn=Ue.create,aa=Dt.create,oa=Pe.create,Nn=ft.create,ca=qe.create,da=Nt.create,ua=gt.create,la=pt.create,ha=nt.create,fa=Ze.create,ga=xe.create,pa=Lt.create,_a=oe.create,ma=$.create,va=$.strictCreate,ya=_t.create,wa=sr.create,ba=mt.create,ka=me.create,Sa=vt.create,xa=Zt.create,Ta=He.create,Ia=et.create,Ea=yt.create,Ca=wt.create,Oa=Ae.create,Ra=bt.create,Ua=st.create,en=ce.create,Pa=Se.create,Aa=Be.create,ja=ce.createWithPreprocess,Ma=Tt.create,Na=()=>jn().optional(),La=()=>Mn().optional(),Za=()=>Nn().optional(),$a={string:t=>ie.create({...t,coerce:!0}),number:t=>Ue.create({...t,coerce:!0}),boolean:t=>ft.create({...t,coerce:!0}),bigint:t=>Pe.create({...t,coerce:!0}),date:t=>qe.create({...t,coerce:!0})},Da=C;var Ie=Object.freeze({__proto__:null,defaultErrorMap:lt,setErrorMap:Wi,getErrorMap:At,makeIssue:jt,EMPTY_PATH:zi,addIssueToContext:_,ParseStatus:z,INVALID:C,DIRTY:Rn,OK:J,isAborted:wr,isDirty:br,isValid:ht,isAsync:Mt,get util(){return M},get objectUtil(){return yr},ZodParsedType:p,getParsedType:Ce,ZodType:P,ZodString:ie,ZodNumber:Ue,ZodBigInt:Pe,ZodBoolean:ft,ZodDate:qe,ZodSymbol:Nt,ZodUndefined:gt,ZodNull:pt,ZodAny:nt,ZodUnknown:Ze,ZodNever:xe,ZodVoid:Lt,ZodArray:oe,ZodObject:$,ZodUnion:_t,ZodDiscriminatedUnion:sr,ZodIntersection:mt,ZodTuple:me,ZodRecord:vt,ZodMap:Zt,ZodSet:He,ZodFunction:et,ZodLazy:yt,ZodLiteral:wt,ZodEnum:Ae,ZodNativeEnum:bt,ZodPromise:st,ZodEffects:ce,ZodTransformer:ce,ZodOptional:Se,ZodNullable:Be,ZodDefault:kt,ZodCatch:$t,ZodNaN:Dt,BRAND:na,ZodBranded:Pn,ZodPipeline:Tt,ZodReadonly:qt,custom:An,Schema:P,ZodSchema:P,late:sa,get ZodFirstPartyTypeKind(){return x},coerce:$a,any:ha,array:_a,bigint:oa,boolean:Nn,date:ca,discriminatedUnion:wa,effect:en,enum:Oa,function:Ia,instanceof:ia,intersection:ba,lazy:Ea,literal:Ca,map:xa,nan:aa,nativeEnum:Ra,never:ga,null:la,nullable:Aa,number:Mn,object:ma,oboolean:Za,onumber:La,optional:Pa,ostring:Na,pipeline:Ma,preprocess:ja,promise:Ua,record:Sa,set:Ta,strictObject:va,string:jn,symbol:da,transformer:en,tuple:ka,undefined:ua,union:ya,unknown:fa,void:pa,NEVER:Da,ZodIssueCode:f,quotelessJson:Bi,ZodError:ae});const Ln="https://cloud-iam.keycloakify.dev/",Zn="keycloakify",$n="starter",{OidcProvider:qa,useOidc:Dn}=nn.createReactOidc({issuerUri:`${Ln}/realms/${Zn}`,clientId:$n,extraQueryParams:()=>({ui_locales:"en",my_custom_param:"value of foo transferred to login page"}),publicUrl:"/",decodedIdTokenSchema:Ie.object({sub:Ie.string(),name:Ie.string(),preferred_username:Ie.string(),favorite_pet:Ie.union([Ie.literal("cat"),Ie.literal("dog"),Ie.literal("bird")])})});function Ha(t){const{locale:e}=t,r=new URL(`${Ln}/realms/${Zn}/account`),n=new URLSearchParams;return n.append("kc_locale",e),n.append("referrer",$n),n.append("referrer_uri",window.location.href),r.search=n.toString(),r.toString()}function Va(){return W.jsx(qa,{children:W.jsx(Ba,{})})}function Ba(){const{isUserLoggedIn:t,login:e,logout:r,oidcTokens:n}=Dn();return W.jsx("div",{className:"App",children:W.jsxs("div",{children:[W.jsx("div",{className:"App-payload",children:t?W.jsxs(W.Fragment,{children:[W.jsxs("h1",{children:["Hello ",n.decodedIdToken.name," !"]}),W.jsx("a",{href:Ha({locale:"en"}),children:"Link to your Keycloak account"}),"",W.jsx("button",{onClick:()=>r({redirectTo:"home"}),children:"Logout"}),W.jsx(Wa,{})]}):W.jsx("button",{onClick:()=>e({doesCurrentHrefRequiresAuth:!1}),children:"Login"})}),W.jsxs("div",{className:"App-logo-wrapper",children:[W.jsx("img",{src:Bn,className:"App-logo rotate",alt:"logo"}),"",W.jsx("img",{src:Wn,className:"App-logo",alt:"logo"})]})]})})}function Wa(){const{oidcTokens:t}=Dn({assertUserLoggedIn:!0});return W.jsx("pre",{style:{textAlign:"left"},children:JSON.stringify(t.decodedIdToken,null,2)})}export{Va as default};
//# sourceMappingURL=index-Ditqwys_.js.map
