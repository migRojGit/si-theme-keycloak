import{r as f,u as K,j as e}from"./index-CbVhUqln.js";import{c as m}from"./useGetClassName-SAC52WvF.js";import{u as M}from"./useGetClassName-BbdUG_W5.js";var x=function(n){return n?n.replace(/[^0-9kK]/g,"").replace(/[kK]{1,}$/,"K"):""},P=function(n){if(!n)return"";var a=x(n);if(a.slice(0,-1).toUpperCase().includes("K"))return"";var o=a.charAt(a.length-1).toUpperCase(),t=a.slice(0,-1).replace(/^0+/,""),d=t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".");return d===""?"0-"+o:d+"-"+o},G=function(n){if(!n)return"";var a=x(n);if(a.slice(0,-1).toUpperCase().includes("K"))return"";var o=a.charAt(a.length-1).toUpperCase(),t=a.slice(0,-1).replace(/^0+/,"");return t===""?"0-"+o:t+"-"+o},L=function(n){var a=Math.abs(n).toString().split(""),o=a.map(function(i){return parseInt(i,10)}).reverse(),t=o.reduce(function(i,s,p){var h=s*(p%6+2);return i+h},0),d=11-t%11;return d===11?"0":d===10?"K":d.toString()},F=function(n){if(!n)return!1;var a=x(n);if(a.length<2)return!1;var o=parseInt(a.slice(0,-1)),t=a.charAt(a.length-1).toUpperCase();return L(o)===t},T=function(){var n=f.useState(null),a=n[0],o=n[1],t=P(a),d=function(h){o(x(h))},i=t==null?void 0:t.slice(0,-1).replace(/\./g,""),s=t.charAt(t.length-1),p=i!==""&&i!=="0-"&&s===L(parseInt(i));return{updateRut:d,rut:{formatted:t!=="0-0"?t:"",raw:t!=="0-0"?""+i+s:""},isValid:p}};const R=new URL(window.location.href).searchParams.get("my_custom_param");R!==null&&console.log("my_custom_param:",R);function $(n){const{kcContext:a,i18n:o,doUseDefaultCss:t,Template:d,classes:i}=n,{getClassName:s}=M({doUseDefaultCss:t,classes:i}),{rut:p,updateRut:h}=T(),{social:v,realm:l,url:C,usernameHidden:j,login:y,auth:g,registrationDisabled:U}=a,{msg:u,msgStr:D}=o,[E,b]=f.useState(!0),[w,I]=f.useState(!1),[k,N]=f.useState("");console.log({kcContext:a});const B=({target:{value:r}})=>{const c=G(r);if(h(c),!F(c)){I(!1),N("");return}I(!0)},W=r=>{const c=r.target.value;N(c),A()},A=()=>{const r=!(w&&k.length>4);b(r)};f.useEffect(()=>{A()},[w,k]);const V=K(r=>{var S;r.preventDefault(),b(!0);const c=r.target;(S=c.querySelector("input[name='email']"))==null||S.setAttribute("name","username"),c.submit()}),_=r=>r==="usernameOrEmail"||r==="username"?"Ingresa tu RUT":u(r);return e.jsx(d,{kcContext:a,i18n:o,doUseDefaultCss:t,classes:i,displayInfo:l.password&&l.registrationAllowed&&!U,displayWide:l.password&&v.providers!==void 0,headerNode:u("doLogIn"),infoNode:e.jsx("div",{id:"kc-registration",children:e.jsxs("span",{children:[u("noAccount"),e.jsx("a",{tabIndex:6,href:C.registrationUrl,children:u("doRegister")})]})}),children:e.jsxs("div",{id:"kc-form",className:m(l.password&&v.providers!==void 0&&s("kcContentWrapperClass")),children:[e.jsx("div",{id:"kc-form-wrapper",className:m(l.password&&v.providers&&[s("kcFormSocialAccountContentClass"),s("kcFormSocialAccountClass")]),children:l.password&&e.jsxs("form",{id:"kc-form-login",onSubmit:V,action:C.loginAction,method:"post",children:[e.jsx("div",{className:s("kcFormGroupClass"),children:!j&&(()=>{const r=l.loginWithEmailAllowed?l.registrationEmailAsUsername?"email":"usernameOrEmail":"username",c=r==="usernameOrEmail"?"username":r;return e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:c,className:s("kcLabelClass"),children:_(r)}),e.jsx("input",{tabIndex:1,id:c,className:s("kcInputClass"),name:c,value:p.formatted,onChange:B,type:"text",autoFocus:!0,autoComplete:"off",maxLength:12})]})})()}),e.jsxs("div",{className:s("kcFormGroupClass"),children:[e.jsx("label",{htmlFor:"password",className:s("kcLabelClass"),children:u("password")}),e.jsx("input",{tabIndex:2,id:"password",className:s("kcInputClass"),name:"password",type:"password",autoComplete:"off",maxLength:20,disabled:!F(p.formatted),onChange:r=>W(r),value:k})]}),e.jsxs("div",{className:m(s("kcFormGroupClass"),s("kcFormSettingClass")),children:[e.jsx("div",{id:"kc-form-options",children:l.rememberMe&&!j&&e.jsx("div",{className:"checkbox",children:e.jsxs("label",{children:[e.jsx("input",{tabIndex:3,id:"rememberMe",name:"rememberMe",type:"checkbox",...y.rememberMe==="on"?{checked:!0}:{}}),u("rememberMe")]})})}),e.jsx("div",{className:s("kcFormOptionsWrapperClass"),children:l.resetPasswordAllowed&&e.jsx("span",{children:e.jsx("a",{tabIndex:5,href:C.loginResetCredentialsUrl,children:u("doForgotPassword")})})})]}),e.jsxs("div",{id:"kc-form-buttons",className:s("kcFormGroupClass"),children:[e.jsx("input",{type:"hidden",id:"id-hidden-input",name:"credentialId",...(g==null?void 0:g.selectedCredential)!==void 0?{value:g.selectedCredential}:{}}),e.jsx("input",{tabIndex:4,className:m(s("kcButtonClass"),s("kcButtonPrimaryClass"),s("kcButtonBlockClass"),s("kcButtonLargeClass")),name:"login",id:"kc-login",type:"submit",value:D("doLogIn"),disabled:E})]})]})}),l.password&&v.providers!==void 0&&e.jsx("div",{id:"kc-social-providers",className:m(s("kcFormSocialAccountContentClass"),s("kcFormSocialAccountClass")),children:e.jsx("ul",{className:m(s("kcFormSocialAccountListClass"),v.providers.length>4&&s("kcFormSocialAccountDoubleListClass")),children:v.providers.map(r=>e.jsx("li",{className:s("kcFormSocialAccountListLinkClass"),children:e.jsx("a",{href:r.loginUrl,id:`zocial-${r.alias}`,className:m("zocial",r.providerId),children:e.jsx("span",{children:r.displayName})})},r.providerId))})})]})})}export{$ as default};
//# sourceMappingURL=Login-BDyWXmFO.js.map
